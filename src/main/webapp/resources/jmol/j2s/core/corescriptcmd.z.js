(function(Kb,Ma,Na,V,Oa,Pa,Hb,K,Ib,Lb,ca,X,Jb,O,Mb,Nb,Ob,Pb,Qb,Rb,Sb,Tb,Ub,Vb,Wb,Xb,Yb,Zb,$b,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc,rc,sc,tc,uc,vc,wc,l,da){Na("J.scriptext");Oa(["J.script.JmolCmdExtension"],"J.scriptext.CmdExt","java.lang.Boolean $.Float $.Long $.Short java.util.Hashtable JU.AU $.BS $.Base64 $.List $.M3 $.M4 $.P3 $.PT $.Quat $.SB $.V3 J.api.Interface J.atomdata.RadiusData J.c.AXES $.STER $.VDW J.i18n.GT JM.Atom $.AtomCollection $.BondSet $.LabelToken J.script.SV $.ScriptCompiler $.ScriptError $.ScriptEval $.ScriptInterruption $.ScriptMathProcessor $.ScriptParam $.T JW.BSUtil $.BoxInfo $.C $.Edge $.Elements $.Escape $.Logger $.Measure $.Parser $.Point3fi $.TempArray $.Txt JV.FileManager $.JC $.StateManager $.Viewer".split(" "),
function(){c$=Hb(function(){this.sm=this.e=this.vwr=null;this.chk=!1;this.st=this.thisCommand=this.fullCommand=null;this.slen=0;this.lastData=null;Pa(this,arguments)},J.scriptext,"CmdExt",null,J.script.JmolCmdExtension);Ib(c$,function(){});da(c$,"init",function(a){this.e=a;this.vwr=this.e.vwr;this.sm=this.e.sm;return this},"~O");da(c$,"dispatch",function(a,b,c){this.chk=this.e.chk;this.fullCommand=this.e.fullCommand;this.thisCommand=this.e.thisCommand;this.slen=this.e.slen;this.st=c;switch(a){case 4098:this.assign();
break;case 135270423:this.cache();break;case 4102:this.calculate();break;case 4103:this.capture();break;case 4105:this.centerAt();break;case 135270405:this.compare();break;case 528395:this.console();break;case 4106:this.connect(1);break;case 1095766024:this.configuration();break;case 135270408:this.data();break;case 1612189718:this.connect(0);break;case 1052700:this.mapProperty();break;case 4126:this.minimize();break;case 1276121113:this.modulation();break;case 4131:this.navigate();break;case 4133:case 135270418:case 1052714:this.plot(c);
break;case 4148:this.show();break;case 528443:this.stereo();break;case 135270422:this.write(null);break;case 23:return this.cgo();case 25:return this.contact();case 17:return this.dipole();case 22:return this.draw();case 24:case 29:case 28:return this.isosurface(a);case 26:return this.lcaoCartoon();case 6:return this.measure(),!0;case 27:return this.mo(b);case 21:return this.polyhedra();case 20:this.ellipsoid();break;case 4:return this.struts()}return!1},"~N,~B,~A");l(c$,"atomExpressionAt",function(a){return this.e.atomExpressionAt(a)},
"~N");l(c$,"checkLength",function(a){this.e.checkLength(a)},"~N");l(c$,"error",function(a){this.e.error(a)},"~N");l(c$,"invArg",function(){this.e.invArg()});l(c$,"invPO",function(){this.error(23)});l(c$,"getShapeProperty",function(a,b){return this.e.getShapeProperty(a,b)},"~N,~S");l(c$,"paramAsStr",function(a){return this.e.paramAsStr(a)},"~N");l(c$,"centerParameter",function(a){return this.e.centerParameter(a)},"~N");l(c$,"floatParameter",function(a){return this.e.floatParameter(a)},"~N");l(c$,"getPoint3f",
function(a,b){return this.e.getPoint3f(a,b)},"~N,~B");l(c$,"getPoint4f",function(a){return this.e.getPoint4f(a)},"~N");l(c$,"intParameter",function(a){return this.e.intParameter(a)},"~N");l(c$,"isFloatParameter",function(a){return this.e.isFloatParameter(a)},"~N");l(c$,"setShapeProperty",function(a,b,c){this.e.setShapeProperty(a,b,c)},"~N,~S,~O");l(c$,"showString",function(a){this.e.showString(a)},"~S");l(c$,"stringParameter",function(a){return this.e.stringParameter(a)},"~N");l(c$,"getToken",function(a){return this.e.getToken(a)},
"~N");l(c$,"tokAt",function(a){return this.e.tokAt(a)},"~N");l(c$,"cache",function(){var a=this.tokAt(1),b=null,c=2;switch(a){case 1276118017:case 1073742119:b=this.e.optParameterAsString(c++);case 1073741882:this.checkLength(c);this.chk||("all".equals(b)&&(b=null),b=this.vwr.cacheFileByName(b,1276118017==a),this.showString(0>b?"cache cleared":b+" bytes "+(1276118017==a?" cached":" removed")));break;default:this.invArg()}});l(c$,"calculate",function(){var a=!1,b=!1,c=null,e=null,d=-2147483648;if(2<=
(this.e.iToken=this.e.slen))switch(this.e.clearDefinedVariableAtomSets(),this.getToken(1).tok){case 1073741824:this.checkLength(2);break;case 1632634891:this.checkLength(2);if(this.chk)return;d=this.vwr.calculateFormalCharges(null);this.showString(J.i18n.GT.i(J.i18n.GT._("{0} charges modified"),d));return;case 1076887572:this.checkLength(2);this.chk||this.vwr.assignAromaticBonds();return;case 1612189718:2!=this.e.slen&&(c=(b=1641025539==this.tokAt(++this.e.iToken))?this.vwr.getSelectedAtoms():this.atomExpressionAt(this.e.iToken),
!b&&1641025539!=this.tokAt(++this.e.iToken)&&(e=this.atomExpressionAt(this.e.iToken)));if(this.chk)return;d=this.vwr.autoHbond(c,e,!1);-2147483648!=d&&this.e.report(J.i18n.GT.i(J.i18n.GT._("{0} hydrogen bonds"),Math.abs(d)));return;case 1613758476:c=2==this.slen?null:this.atomExpressionAt(2);this.e.checkLast(this.e.iToken);this.chk||this.vwr.addHydrogens(c,!1,!1);return;case 1112541196:this.e.iToken=1;c=2==this.slen?null:this.atomExpressionAt(2);this.e.checkLast(this.e.iToken);this.chk||this.vwr.calculatePartialCharges(c);
return;case 1073742102:this.chk||this.showString(this.vwr.calculatePointGroup());return;case 1112539150:this.checkLength(2);this.chk||(this.vwr.calculateStraightness(),this.vwr.addStateScript("set quaternionFrame '"+this.vwr.getQuaternionFrame()+"'; calculate straightness",!1,!0));return;case 1641025539:c=4>this.slen?null:this.atomExpressionAt(2);switch(this.tokAt(++this.e.iToken)){case 1052714:break;case 1073741915:b=!0;break;case 0:b=this.vwr.getBoolean(603979826);break;default:this.invArg()}this.chk||
this.showString(this.vwr.calculateStructures(c,b,!0));return;case 1708058:c=this.e.iToken+1<this.slen?this.atomExpressionAt(++this.e.iToken):null;e=this.e.iToken+1<this.slen?this.atomExpressionAt(++this.e.iToken):null;this.checkLength(++this.e.iToken);this.chk||(d=this.vwr.calculateStruts(c,e),0<d&&(this.setShapeProperty(1,"type",Integer.$valueOf(32768)),this.e.setShapePropertyBs(1,"color",Integer.$valueOf(16777215),null),this.e.setShapeTranslucency(1,"","translucent",0.5,null),this.setShapeProperty(1,
"type",Integer.$valueOf(1023))),this.showString(J.i18n.GT.i(J.i18n.GT._("{0} struts added"),d)));return;case 3145756:a=!0;case 1112539151:b=!1;switch(this.tokAt(2)){case 135266325:this.e.iToken++;break;case 0:b=!a;break;case 1073741952:b=!0;this.e.iToken++;break;default:b=!0}c=this.e.iToken+1<this.slen?this.atomExpressionAt(++this.e.iToken):this.vwr.getSelectedAtoms();this.checkLength(++this.e.iToken);this.chk||this.vwr.calculateSurface(c,b?3.4028235E38:-1);return}this.e.errorStr2(53,"CALCULATE",
"aromatic? hbonds? hydrogen? formalCharge? partialCharge? pointgroup? straightness? structure? struts? surfaceDistance FROM? surfaceDistance WITHIN?")});l(c$,"capture",function(){if(!this.chk&&!this.vwr.allowCapture())this.showString("Cannot capture on this platform");else{var a=this.vwr.getInt(553648132),b=10,c=0,e="",d=this.vwr.captureParams,f=!this.vwr.getAnimationReplayMode().name().equals("ONCE"),g=this.tokAt(1),h="";switch(g){case 0:c=1150985;break;case 4:e=this.e.optParameterAsString(1);if(0==
e.length){c=1150985;break}e.endsWith(".gif")||(e+=".gif");var g=null,c="y",k;switch(this.tokAt(2)){case 1073742129:f=!0;k=3;c=2==this.tokAt(3)?"y":this.e.optParameterAsString(k++).toLowerCase();g=0==this.tokAt(k)?5:this.intParameter(k++);g=JU.PT.rep("; rotate Y 10 10;delay 2.0; rotate Y -10 -10; delay 2.0;rotate Y -10 -10; delay 2.0;rotate Y 10 10;delay 2.0","10",""+g);break;case 1611141175:f=!0;k=3;c=this.e.optParameterAsString(k).toLowerCase();0<c.length&&k++;g="; rotate Y 360 30;delay 15.0;";2==
this.tokAt(k)&&(h=" "+(a=this.intParameter(k++)));break;case 3:b=this.floatParameter(2);break;case 2:a=this.intParameter(2)}if(null!=g){this.chk||this.vwr.setNavigationMode(!1);if(""===c||0>"xyz".indexOf(c))c="y";g=JU.PT.rep(g,"Y",c);g="capture "+JU.PT.esc(e)+h+g+";capture;";this.e.cmdScript(0,null,g);return}null!=d&&new java.util.Hashtable;c=1073742032;d=new java.util.Hashtable;f||this.showString(J.i18n.GT.o(J.i18n.GT._("Note: Enable looping using {0}"),["ANIMATION MODE LOOP"]));this.showString(J.i18n.GT.o(J.i18n.GT._("Animation delay based on: {0}"),
["ANIMATION FPS "+a]));d.put("captureFps",Integer.$valueOf(a));break;case 1073741874:case 1048589:case 1048588:this.checkLength(2);c=g;break;default:this.invArg()}this.chk||null==d||(d.put("type","GIF"),d.put("fileName",e),d.put("quality",Integer.$valueOf(-1)),d.put("endTime",Long.$valueOf(System.currentTimeMillis()+Clazz_floatToLong(1E3*b))),d.put("captureMode",J.script.T.nameOf(c).toLowerCase()),d.put("captureLooping",f?Boolean.TRUE:Boolean.FALSE),a=this.vwr.processWriteOrCapture(d),JW.Logger.info(a))}});
l(c$,"centerAt",function(){var a=this.getToken(1).tok;switch(a){case 1073741826:case 96:case 1679429641:break;default:this.invArg()}var b=JU.P3.new3(0,0,0);5==this.slen?(b.x=this.floatParameter(2),b.y=this.floatParameter(3),b.z=this.floatParameter(4)):this.e.isCenterParameter(2)?(b=this.centerParameter(2),this.e.checkLast(this.e.iToken)):this.checkLength(2);this.chk||this.vwr.setCenterAt(a,b)});l(c$,"cgo",function(){var a=this.e;this.sm.loadShape(23);if(1073742001==this.tokAt(1)&&this.listIsosurface(23))return!1;
for(var b=0,c=null!=this.initIsosurface(23),e=c&&null==this.getShapeProperty(23,"ID"),d=!1,f=null,g=3.4028235E38,h=[-2147483648],k=0,E=a.iToken;E<this.slen;++E){var s=null,t=null;switch(this.getToken(E).tok){case 7:case 269484096:case 1073742195:(null!=f||e)&&this.invArg();f=a.listParameter(E,2,2147483647);E=a.iToken;continue;case 1073742138:++E>=this.slen&&this.error(34);switch(this.getToken(E).tok){case 2:k=this.intParameter(E);continue;case 3:k=Math.round(100*this.floatParameter(E));continue}this.error(34);
break;case 1766856708:case 603979967:case 1073742074:g=this.getColorTrans(a,E,!1,h);E=a.iToken;c=!0;continue;case 1074790550:this.setShapeId(23,++E,c);e=null==this.getShapeProperty(23,"ID");E=a.iToken;break;default:if(!a.setMeshDisplayProperty(23,0,a.theTok)){if(269484209==a.theTok||J.script.T.tokAttr(a.theTok,1073741824)){this.setShapeId(23,E,c);E=a.iToken;break}this.invArg()}0==b&&(b=E);E=a.iToken;continue}c=12291!=a.theTok;null!=f&&!d&&(s="points",t=Integer.$valueOf(k),d=!0,k=0);null!=s&&this.setShapeProperty(23,
s,t)}this.finalizeObject(23,h[0],g,k,null!=f,f,b,null);return!0});l(c$,"compare",function(){var a=!1,b=!1,c=!1,e=!1,d=!1,f=null,g=null,h=null,k=null,E=null,s=null;this.e.iToken=0;var t=this.isFloatParameter(1)?this.floatParameter(++this.e.iToken):NaN,n=this.atomExpressionAt(++this.e.iToken),H=null,m=null;this.e.isArrayParameter(++this.e.iToken)?H=this.e.getPointArray(this.e.iToken,-1):1141899265!=this.tokAt(this.e.iToken)&&(m=this.atomExpressionAt(this.e.iToken));var z=null,l=!1,G=null,r=JW.BSUtil.copy(n);
null!=m&&r.or(m);for(var r=e=null==H&&null!=m&&r.equals(n),q=this.e.iToken+1;q<this.slen;++q)switch(this.getToken(q).tok){case 4115:r=!0;break;case 135267336:if(l=!0,4!=this.tokAt(q+1)){G="*";break}case 135267335:G=this.stringParameter(++q);break;case 1678770178:b=d=!0;G=this.paramAsStr(++q);G.equalsIgnoreCase("SMILES")&&(l=!0,G="*");break;case 3:case 2:t=Math.abs(this.floatParameter(q));break;case 269484080:break;case 3158024:z=this.atomExpressionAt(++q);q=this.e.iToken;break;case 10:case 1048577:null!=
s&&this.invArg();var h=this.atomExpressionAt(this.e.iToken),y=e?0:this.tokAt(this.e.iToken+1),k=null==H&&this.e.isArrayParameter(this.e.iToken+1)?null:10==y||1048577==y?this.atomExpressionAt(++this.e.iToken):JW.BSUtil.copy(h);null!=z&&(h.and(z),null!=k&&k.and(z));null==k?H=this.e.getPointArray(++this.e.iToken,-1):k.and(m);null==E&&(E=new JU.List);E.addLast([h,k]);q=this.e.iToken;break;case 7:null!=E&&this.invArg();a=!0;f=this.e.getQuaternionArray(this.e.theToken.getList(),1073742001);this.getToken(++q);
g=this.e.getQuaternionArray(this.e.theToken.getList(),1073742001);null==s&&(s=new JU.List);s.addLast([f,g]);break;case 1073742077:a=!0;break;case 135266320:case 1141899265:a=!1;break;case 528432:b=!0;break;case 4160:c=!0;break;default:this.invArg()}if(!this.chk){r&&(t=0);Float.isNaN(t)||0>t?t=1:!b&&!c&&(b=c=!0);e=0!=t;y=!a&&null==G||null!=H;null==E&&null==s&&(null==z?(h=y?this.vwr.getAtomBitSet("spine"):new JU.BS,0>h.nextSetBit(0)?(h=n,k=m):(k=JW.BSUtil.copy(h),h.and(n),k.and(m))):(h=JW.BSUtil.copy(n),
k=JW.BSUtil.copy(m),h.and(z),k.and(z),h.and(n),k.and(m)),E=new JU.List,E.addLast([h,k]));if(r){n=this.vwr.getModelBitSet(n,!1);z=Array(n.cardinality());q=0;for(k=n.nextSetBit(0);0<=k;k=n.nextSetBit(k+1),q++)z[q]=this.vwr.getModelUndeletedAtomsBitSet(k)}else z=[n];for(k=0;k<z.length;k++){for(var n=z[k],x=O(2,0),u=null,I=new JU.List,D=null,F=r?new JU.List:E,q=0;q<E.size();++q){var S=E.get(q);r&&F.addLast(S=[JW.BSUtil.copy(S[0]),S[1]]);S[0].and(n)}var M=null,v=null;if(y){null!=H&&(F.clear(),F.addLast([h,
H]));try{D=this.vwr.getCenterAndPoints(F,!0)}catch(K){if(ca(K,Exception))this.invArg();else throw K;}u=JW.Measure.calculateQuaternionRotation(D,x,!0);q=Float.isNaN(x[1])?NaN:Math.round(100*x[0])/100;x=Float.isNaN(x[1])?NaN:Math.round(100*x[1])/100;this.showString("RMSD "+q+" --\x3e "+x+" Angstroms")}else if(a){if(null==s)for(q=0;q<F.size();q++){S=F.get(q);f=this.vwr.getAtomGroupQuaternions(S[0],2147483647);g=this.vwr.getAtomGroupQuaternions(S[1],2147483647);for(u=0;u<f.length&&u<g.length;u++)I.addLast(g[u].div(f[u]))}else for(u=
0;u<f.length&&u<g.length;u++)I.addLast(g[u].div(f[u]));x[0]=0;f=I.toArray(Array(I.size()));u=JU.Quat.sphereMean(f,x,1E-4);this.showString("RMSD = "+x[0]+" degrees")}else{q=new JU.M4;M=new JU.P3;if(("*".equals(G)||"".equals(G))&&null!=n)try{G=this.vwr.getSmiles(n)}catch(P){if(ca(P,Exception))this.e.evalError(P.getMessage(),null);else throw P;}if(d){var V;if(null==n||null==m||null==(V=this.e.getSmilesExt().getFlexFitList(n,m,G,!l)))break;this.vwr.setDihedrals(V,null,1)}x=this.e.getSmilesExt().getSmilesCorrelation(n,
m,G,null,null,q,null,!l,!1,null,M,!1,!1);if(Float.isNaN(x)){this.showString("structures do not match");break}c&&(v=new JU.V3,q.getTranslation(v));b&&(u=new JU.M3,q.getRotationScale(u),u=JU.Quat.newM(u));this.showString("RMSD = "+x+" Angstroms")}null!=D&&(M=D[0][0]);null==M&&(D=this.vwr.getCenterAndPoints(F,!0),M=D[0][0]);F=new JU.P3;x=NaN;c&&(null==v&&(v=JU.V3.newVsub(D[1][0],M)),x=1E10);b&&(null==u&&this.e.evalError("option not implemented",null),F.add2(M,u.getNormal()),x=u.getTheta(),0==x&&c&&(0.01<
v.length()?x=1E10:b=c=e=!1));if(!Float.isNaN(x)&&!Float.isNaN(F.x)&&(D=null,b&&(c&&0!=t)&&(D=this.vwr.getAtomPointVector(n),q=J.script.ScriptMathProcessor.getMatrix4f(u.getMatrix(),v),D=JW.Measure.transformPoints(D,q,M)),this.e.useThreads()||(e=!1),this.vwr.rotateAboutPointsInternal(this.e,M,F,x/t,x,e,n,v,D,null)&&e&&this.e.isJS))throw new J.script.ScriptInterruption(this.e,"compare",1);}}});l(c$,"configuration",function(){var a;if(1==this.slen)a=this.vwr.setConformation(),this.vwr.addStateScriptRet("select",
null,this.vwr.getSelectedAtoms(),null,"configuration",!0,!1);else{var b=this.intParameter(this.e.checkLast(1));if(this.chk)return;a=this.vwr.getConformation(this.vwr.getCurrentModelIndex(),b-1,!0);this.vwr.addStateScript("configuration "+b+";",!0,!1)}this.chk||(this.setShapeProperty(1,"type",Integer.$valueOf(30720)),this.e.setShapeSizeBs(1,0,a),this.vwr.autoHbond(a,a,!0),this.vwr.select(a,!1,0,this.e.tQuiet))});l(c$,"measure",function(){var a=this.e,b=null,c=0,e=null;if(2==this.slen)switch(this.tokAt(1)){case 1048588:this.setShapeProperty(6,
"hideAll",Boolean.TRUE);return;case 12291:this.chk||this.vwr.clearAllMeasurements();return}this.vwr.loadShape(6);switch(this.tokAt(1)){case 135267335:var d=this.stringParameter(3==this.slen?2:4);if(this.chk)return;var f=this.vwr.ms.at,b=this.vwr.getAtomCount(),c=null;try{c=this.vwr.getSmilesMatcher().getCorrelationMaps(d,f,b,this.vwr.getSelectedAtoms(),!0,!1)}catch(g){if(ca(g,Exception))a.evalError(g.getMessage(),null);else throw g;}if(null==c)return;this.setShapeProperty(6,"maps",c);return}switch(this.slen){case 2:switch(this.getToken(1).tok){case 0:case 1048589:this.vwr.loadShape(6);
this.setShapeProperty(6,"hideAll",Boolean.FALSE);return;case 1073742001:this.chk||a.showStringPrint(this.vwr.getMeasurementInfoAsString(),!1);return;case 4:this.setShapeProperty(6,"setFormats",this.stringParameter(1));return}a.errorStr(24,"ON, OFF, DELETE");break;case 3:switch(this.getToken(1).tok){case 12291:if(1048579==this.getToken(2).tok)this.chk||this.vwr.clearAllMeasurements();else{var h=this.intParameter(2)-1;this.chk||this.vwr.deleteMeasurement(h)}return}}for(var k=0,E=0,s=-1,t=-1,n=-1,H=
X(5,0),m=[3.4028235E38,3.4028235E38],z=!1,l=!1,G=!1,r=!0,q=null,y=null,d=269484114,x=f=null,u=new JU.List,I=new JU.BS,D=null,F=null,S=0,M=0,h=1;h<this.slen;++h)switch(this.getToken(h).tok){case 1074790550:1!=h&&this.invArg();b=a.optParameterAsString(++h);continue;case 1073741824:a.errorStr(24,"ALL, ALLCONNECTED, DELETE");break;default:this.error(15);break;case 269484144:135266310!=this.tokAt(h+1)&&this.invArg();h++;G=!0;break;case 135266310:case 1073741834:case 1048579:l=1073741834==a.theTok;t=-1;
z=!0;l&&G&&this.invArg();break;case 1766856708:c=JW.C.getColix(a.getArgbParam(++h));h=a.iToken;break;case 1073742066:a.isPoint3f(++h)?(e=this.getPoint3f(h,!1),e=[1,e.x,e.y,e.z,0,0,0]):e=a.floatParameterSet(h,7,7);h=a.iToken;break;case 1666189314:case 1073741916:M=K((1666189314==a.theTok?2E3:1E3)*this.floatParameter(++h));null!=b&&0>=M&&(M=-1);break;case 3:null!=q&&this.invArg();r=z=!0;n=(n+1)%2;m[n]=this.floatParameter(h);break;case 12291:269484114!=d&&this.invArg();d=12291;break;case 4114:var v=
this.floatParameter(++h),T=this.paramAsStr(++h),P=this.paramAsStr(++h);this.chk||(x=this.vwr.getFont3D(T,P,v));break;case 2:v=this.intParameter(h);if(z)r=!0,n=(n+1)%2,m[n]=v;else{t=this.vwr.getAtomIndexFromAtomNumber(v);if(!this.chk&&0>t)return;null!=D&&this.invArg();4<(H[0]=++k)&&a.bad();H[k]=t}break;case 1095761935:s=this.intParameter(++h);break;case 1048588:269484114!=d&&this.invArg();d=1048588;break;case 1048589:269484114!=d&&this.invArg();d=1048589;break;case 1073742114:r=z=!0;t=-1;break;case 1073741989:case 1073741990:y=
Boolean.$valueOf(1073741989==a.theTok);z=!0;G=1073741990==a.theTok;break;case 1649412120:0<=n&&this.invArg();q=a.encodeRadiusParameter(h,!1,!0);if(null==q)return;q.values=m;h=a.iToken;z=G=!0;y=Boolean.$valueOf(!1);1==S&&(S++,k++,v=JW.BSUtil.copy(I),JW.BSUtil.invertInPlace(v,this.vwr.getAtomCount()),v.and(this.vwr.getAtomsWithinRadius(5,I,!1,null)),u.addLast(v));break;case 10:case 1048577:case 1048586:case 8:case 1048582:(10==a.theTok||1048577==a.theTok)&&S++;0<=t&&this.invArg();a.expressionResult=
Boolean.FALSE;D=this.centerParameter(h);if(V(a.expressionResult,JU.BS)&&(D=I=a.expressionResult,!this.chk&&0==I.length()))return;V(D,JU.P3)&&(k=new JW.Point3fi,k.setT(D),k.mi=s,D=k);4<(k=++E)&&a.bad();h=a.iToken;u.addLast(D);break;case 4:f=this.stringParameter(h);break;case 1073742164:F=a.tickParamAsStr(h,!1,!0,!0),h=a.iToken,d=1060866}(null!=q&&(0<=n||2!=k)||2>k&&null==b&&(null==F||1==k))&&a.bad();null!=f&&0!=f.indexOf(k+":")&&(f=k+":"+f);r&&m[1]<m[0]&&(m[1]=m[0],m[0]=3.4028235E38==m[1]?3.4028235E38:
-200);if(!this.chk)if(null!=D||null!=F)null==q&&(q=new J.atomdata.RadiusData(m,0,null,null)),null==D&&(F.id="default"),null!=D&&(null!=f&&269484114==d)&&(d=1060866),a=null,null!=x&&(a=J.api.Interface.getInterface("JM.Text").newLabel(this.vwr.getGraphicsData(),x,"",c,0,0,0,null)),null!=a&&(a.pymolOffset=e),this.setShapeProperty(6,"measure",this.vwr.newMeasurementData(b,u).set(d,null,q,f,null,F,l,G,y,z,M,c,a));else switch(a=null==b?H:b,d){case 12291:this.setShapeProperty(6,"delete",a);break;case 1048589:this.setShapeProperty(6,
"show",a);break;case 1048588:this.setShapeProperty(6,"hide",a);break;default:this.setShapeProperty(6,null==f?"toggle":"toggleOn",a),null!=f&&this.setShapeProperty(6,"setFormats",f)}});l(c$,"connect",function(a){var b=this.e,c=O(2,0),e=Array(2);e[0]=e[1]=this.vwr.getSelectedAtoms();var d=NaN,f=[-2147483648],g=0,h=131071,k=1073742026,E=!1,s=!1,t=!1,n=3.4028235E38,l=!1,m=0,z=0,C=new JU.BS,G=!1,r=0,q=0,y=0,x=!1;if(1==this.slen)this.chk||this.vwr.rebondState(b.$isStateScript);else{for(;a<this.slen;++a){switch(this.getToken(a).tok){case 1048589:case 1048588:this.checkLength(2);
this.chk||this.vwr.rebondState(b.$isStateScript);return;case 2:case 3:if(0<m){(s||l)&&b.error(23);h=JW.Edge.getBondOrderFromFloat(this.floatParameter(a));131071==h&&this.invArg();s=!0;break}2<++z&&b.bad();var u=this.floatParameter(a);269484210==this.tokAt(a+1)&&(u=-u/100,a++);c[g++]=u;break;case 10:case 1048577:(2<m||G&&0<m)&&b.bad();(s||l)&&this.invArg();e[m++]=this.atomExpressionAt(a);G=b.isBondSet;if(2==m){for(var u=b.iToken,I=a;I<u;I++)if(1073741824==this.tokAt(I)&&this.paramAsStr(I).equals("_1")){r=
a;break}b.iToken=u}a=b.iToken;break;case 1087373318:x=!0;break;case 1766856708:case 603979967:case 1073742074:l=!0;n=this.getColorTrans(b,a,!1,f);a=b.iToken;break;case 1074790662:d=1073741852==this.tokAt(2);this.checkLength(d?3:2);this.chk||this.vwr.setPdbConectBonding(d,b.$isStateScript);return;case 1073741830:case 1073741852:case 1073741904:case 1073742025:case 1073742026:t=!0;++a!=this.slen&&this.invArg();k=b.theTok;1073741852==k&&!(131071==h||2048==h||515==h)&&this.invArg();break;case 1708058:l||
(f[0]=16777215,n=0.5,d=this.vwr.getFloat(570425406),l=!0),t||(k=1073742026),t=!0;case 1073741824:if(b.isColorParam(a)){q=-a;break}case 1076887572:case 1612189718:h=this.paramAsStr(a);131071==(h=J.script.ScriptParam.getBondOrderFromString(h))&&this.invArg();s&&b.error(18);s=!0;switch(h){case 33:switch(this.tokAt(a+1)){case 3:h=J.script.ScriptParam.getPartialBondOrderFromFloatEncodedInt(this.st[++a].intValue);break;case 2:h=this.intParameter(++a)}break;case 2048:2==this.tokAt(a+1)&&(h=this.intParameter(++a)<<
11,y=this.floatParameter(++a))}break;case 1666189314:d=this.floatParameter(++a);l=!0;break;case 1048587:case 12291:++a!=this.slen&&this.invArg();k=12291;E=!0;l=!1;break;default:q=a}0<a&&(q==-a||q==a&&b.isColorParam(a)?(l=!0,f[0]=b.getArgbParam(a),a=b.iToken):q==a&&this.invArg())}if(!this.chk){2>g&&(0==g&&(c[0]=1E8),c[1]=c[0],c[0]=0.1);l&&(s||(h=65535),t||(k=1073742025));s=g=0;if(0<r){y=new JU.BS;b.definedAtomSets.put("_1",y);x=e[0];for(t=x.nextSetBit(0);0<=t;t=x.nextSetBit(t+1))y.set(t),e=this.vwr.makeConnections(c[0],
c[1],h,k,y,this.atomExpressionAt(r),C,G,!1,0),g+=Math.abs(e[0]),s+=e[1],y.clear(t)}else e=this.vwr.makeConnections(c[0],c[1],h,k,e[0],e[1],C,G,x,y),g+=Math.abs(e[0]),s+=e[1];c=b.doReport();E?c&&b.report(J.i18n.GT.i(J.i18n.GT._("{0} connections deleted"),s)):(l&&(this.vwr.selectBonds(C),Float.isNaN(d)||b.setShapeSizeBs(1,Math.round(2E3*d),null),this.finalizeObject(1,f[0],n,0,!1,null,0,C),this.vwr.selectBonds(null)),c&&b.report(J.i18n.GT.o(J.i18n.GT._("{0} new bonds; {1} modified"),[Integer.$valueOf(g),
Integer.$valueOf(s)])))}}},"~N");l(c$,"console",function(){switch(this.getToken(1).tok){case 1048588:this.chk||this.vwr.showConsole(!1);break;case 1048589:this.chk||this.vwr.showConsole(!0);break;case 1073741882:this.chk||this.vwr.clearConsole();break;case 135270422:this.showString(this.stringParameter(2));break;default:this.invArg()}});l(c$,"contact",function(){var a=this.e;this.sm.loadShape(25);if(1073742001==this.tokAt(1)&&this.listIsosurface(25))return!1;var b=0;a.iToken=1;for(var c=null!=this.initIsosurface(25),
e=c&&null==this.getShapeProperty(25,"ID"),d=null,f=null,g=null,h=null,k=null,E=!1,s=new JU.SB,t=2147483647,n=135266319,l=0,m=NaN,z=NaN,C=!0,G=null,r=null,q=0,y=!1,x=1<a.iToken,u=a.iToken;u<this.slen;++u){switch(g=this.getToken(u).tok){default:x=!0;if(!a.setMeshDisplayProperty(25,0,a.theTok)){269484209!=a.theTok&&!J.script.T.tokAttr(a.theTok,1073741824)&&this.invArg();this.setShapeId(25,u,c);u=a.iToken;break}0==b&&(b=u);u=a.iToken;continue;case 1074790550:x=!0;this.setShapeId(25,++u,c);e=null==this.getShapeProperty(25,
"ID");u=a.iToken;break;case 1766856708:switch(this.tokAt(u+1)){case 1073741914:g=0;E=!0;s.append(" color density");u++;break;case 1141899272:g=0,y=!0,s.append(" color type"),u++}if(0==g)break;case 603979967:case 1073742074:x=!0;0==q&&(q=u);a.setMeshDisplayProperty(25,u,a.theTok);u=a.iToken;break;case 554176565:x=!0;r=this.getCapSlabObject(u,!1);this.setShapeProperty(25,"slab",r);u=a.iToken;break;case 1073741914:E=!0;s.append(" density");this.isFloatParameter(u+1)&&(null==k&&(k=O(1,0)),k[0]=-Math.abs(this.floatParameter(++u)),
s.append(" "+-k[0]));break;case 1073742122:c=this.floatParameter(++u);0<c&&(s.append(" resolution ").appendF(c),this.setShapeProperty(25,"resolution",Float.$valueOf(c)));break;case 135266325:case 1276118018:m=this.floatParameter(++u);s.append(" within ").appendF(m);break;case 269484193:case 2:case 3:h=a.encodeRadiusParameter(u,!1,!1);if(null==h)return!1;s.append(" ").appendO(h);u=a.iToken;break;case 1073741990:case 1073741989:G=1073741989==g?Boolean.TRUE:Boolean.FALSE;s.append(" ").appendO(a.theToken.value);
break;case 1073742020:t=this.intParameter(++u);break;case 1612189718:case 1073741881:case 1649412120:l=g;s.append(" ").appendO(a.theToken.value);break;case 1073742135:this.isFloatParameter(u+1)&&(z=this.floatParameter(++u));case 1074790451:case 1073742036:case 3145756:C=!1;case 1276117512:case 1073741961:case 135266319:case 4106:n=g;s.append(" ").appendO(a.theToken.value);1073742135==g&&s.append(" ").appendF(z);break;case 1073742083:k=a.floatParameterSet(++u,1,10);u=a.iToken;break;case 10:case 1048577:(e||
null!=f)&&this.invArg(),g=JW.BSUtil.copy(this.atomExpressionAt(u)),u=a.iToken,null==d?d=g:f=g,s.append(" ").append(JW.Escape.eBS(g))}c=12291!=a.theTok}!x&&null==d&&this.error(13);if(this.chk)return!1;if(null!=d){1649412120==l&&null==h&&(h=new J.atomdata.RadiusData(null,0,J.atomdata.RadiusData.EnumType.OFFSET,J.c.VDW.AUTO));u=null==h?new J.atomdata.RadiusData(null,0.26,J.atomdata.RadiusData.EnumType.OFFSET,J.c.VDW.AUTO):h;f=1073742036==n&&null==f&&null!=G&&G.booleanValue()?d:a.getMathExt().setContactBitSets(d,
f,C,m,u,!0);switch(n){case 1074790451:case 1073742135:u=a.lookupIdentifierValue("solvent");d.andNot(u);f.andNot(u);f.andNot(d);break;case 3145756:f.andNot(d);break;case 1073742036:2147483647==t&&(t=100),this.setShapeProperty(25,"minset",Integer.$valueOf(t)),s.append(" minSet ").appendI(t),null==k&&(k=[0.5,2])}null!=G&&(k=null==k?O(2,0):JU.AU.ensureLengthA(k,2),k[1]=G.booleanValue()?1:2);null!=k&&s.append(" parameters ").append(JW.Escape.eAF(k));this.setShapeProperty(25,"set",[Integer.$valueOf(l),
Integer.$valueOf(n),Boolean.$valueOf(E),Boolean.$valueOf(y),d,f,h,Float.$valueOf(z),k,s.toString()]);0<q&&a.setMeshDisplayProperty(25,q,0)}0<b&&(a.setMeshDisplayProperty(25,b,0)||this.invArg());null!=r&&null!=d&&this.setShapeProperty(25,"slab",r);if(null!=d&&(1073742036==n||C)){a=this.getShapeProperty(25,"volume");if(JU.PT.isAD(a)){for(u=b=0;u<a.length;u++)b+=Math.abs(a[u]);a=Float.$valueOf(b)}b=this.getShapeProperty(25,"nSets").intValue();if(E||1276117512!=n)this.showString((0==b?"":b+" contacts with ")+
"net volume "+a+" A^3")}return!0});l(c$,"dipole",function(){var a=this.e,b=null,c=null,e=!1,d=!1,f=!1;this.sm.loadShape(17);if(1073742001==this.tokAt(1)&&this.listIsosurface(17))return!1;this.setShapeProperty(17,"init",null);if(1==this.slen)return this.setShapeProperty(17,"thisID",null),!1;for(var g=1;g<this.slen;++g){c=b=null;switch(this.getToken(g).tok){case 1048589:b="on";break;case 1048588:b="off";break;case 12291:b="delete";break;case 2:case 3:b="value";c=Float.$valueOf(this.floatParameter(g));
break;case 10:b="atomBitset";case 1048577:null==b&&(b=e||d?"endSet":"startSet");c=this.atomExpressionAt(g);g=a.iToken;e=!0;break;case 1048586:case 8:c=this.getPoint3f(g,!0);g=a.iToken;b=e||d?"endCoord":"startCoord";d=!0;break;case 1678770178:b="bonds";break;case 4102:b="calculate";break;case 1074790550:this.setShapeId(17,++g,f);g=a.iToken;break;case 135267329:b="cross";c=Boolean.TRUE;break;case 1073742040:b="cross";c=Boolean.FALSE;break;case 1073742066:c=this.floatParameter(++g);2==a.theTok?(b="offsetPercent",
c=Integer.$valueOf(K(c))):(b="offset",c=Float.$valueOf(c));break;case 1073742068:b="offsetSide";c=Float.$valueOf(this.floatParameter(++g));break;case 1073742188:b="value";c=Float.$valueOf(this.floatParameter(++g));break;case 1073742196:b="width";c=Float.$valueOf(this.floatParameter(++g));break;default:if(269484209==a.theTok||J.script.T.tokAttr(a.theTok,1073741824)){this.setShapeId(17,g,f);g=a.iToken;break}this.invArg()}f=12291!=a.theTok&&4102!=a.theTok;null!=b&&this.setShapeProperty(17,b,c)}(d||e)&&
this.setShapeProperty(17,"set",null);return!0});l(c$,"draw",function(){var a=this.e;this.sm.loadShape(22);switch(this.tokAt(1)){case 1073742001:if(this.listIsosurface(22))return!1;break;case 1073742102:var b=2,a=1073742138==this.tokAt(b)?"":this.e.optParameterAsString(b);a.equals("chemicalShift")&&(a="cs");var c=1,e=0;0<a.length&&this.isFloatParameter(++b)&&(e=this.intParameter(b++));1073742138==this.tokAt(b)&&(c=this.floatParameter(++b));this.chk||this.e.runScript(this.vwr.getPointGroupAsString(!0,
a,e,c));return!1;case 137363467:case 135270418:case 1052714:return this.plot(this.st),!1}for(var d=!1,f=!1,g=!1,h=!1,k=!1,E=0,s=3.4028235E38,t=[-2147483648],n=0,l="",m=0,c=null,e=this.initIsosurface(22),z=(b=null!=e)&&null==this.getShapeProperty(22,"ID"),C=null,G=0,r=a.iToken;r<this.slen;++r){var q=null,y=null;switch(this.getToken(r).tok){case 1614417948:case 1679429641:if(this.chk)break;d=this.vwr.getPlaneIntersection(a.theTok,null,n/100,0);n=0;q="polygon";y=d;d=!0;break;case 4106:C=X(4,0);G=4;d=
a.floatParameterSet(++r,4,4);r=a.iToken;for(b=0;4>b;b++)C[b]=K(d[b]);d=!0;break;case 1678770178:case 1141899265:if(null==C||G>(1095761924==a.theTok?2:3))G=0,C=[-1,-1,-1,-1];C[G++]=this.atomExpressionAt(++r).nextSetBit(0);r=a.iToken;C[G++]=1678770178==a.theTok?this.atomExpressionAt(++r).nextSetBit(0):-1;r=a.iToken;d=!0;break;case 554176565:switch(this.getToken(++r).tok){case 1048582:q="slab";y=a.objectNameParameter(++r);r=a.iToken;d=!0;break;default:this.invArg()}break;case 135267842:switch(this.getToken(++r).tok){case 1614417948:case 1679429641:E=
a.theTok;h=!0;continue;case 1048582:q="intersect";y=a.objectNameParameter(++r);r=a.iToken;d=h=!0;break;default:this.invArg()}break;case 1073742106:var q="polygon",d=!0,y=new JU.List,x=0,u=0,I=null,D=null;if(a.isArrayParameter(++r))I=a.getPointArray(r,-1),x=I.length;else{x=Math.max(0,this.intParameter(r));I=Array(x);for(b=0;b<x;b++)I[b]=this.centerParameter(++a.iToken)}switch(this.getToken(++a.iToken).tok){case 11:case 12:r=J.script.SV.newT(a.theToken);r.toArray();D=r.getList();u=D.size();break;case 7:D=
a.theToken.getList();u=D.size();break;default:u=Math.max(0,this.intParameter(a.iToken))}r=JU.AU.newInt2(u);for(b=0;b<u;b++){var F=null==D?a.floatParameterSet(++a.iToken,3,4):J.script.SV.flistValue(D.get(b),0);(3>F.length||4<F.length)&&this.invArg();r[b]=[K(F[0]),K(F[1]),K(F[2]),3==F.length?7:K(F[3])]}0<x?(y.addLast(I),y.addLast(r)):y=null;r=a.iToken;break;case 1297090050:f=null;g=0;h=null;switch(this.tokAt(++r)){case 4:f=this.stringParameter(r);break;case 12:f=J.script.SV.sValue(this.getToken(r));
break;default:a.isCenterParameter(r)||(g=this.intParameter(r++));a.isCenterParameter(r)&&(c=this.centerParameter(r));a.isCenterParameter(a.iToken+1)&&(h=this.centerParameter(++a.iToken));if(this.chk)return!1;r=a.iToken}k=null;null==c&&r+1<this.slen&&(c=this.centerParameter(++r),k=10==this.tokAt(r)||1048577==this.tokAt(r)?this.atomExpressionAt(r):null);a.checkLast(a.iToken);this.chk||a.runScript(this.vwr.getSymmetryInfo(k,f,g,c,h,e,135176));return!1;case 4115:k=!0;continue;case 1048586:case 9:case 8:if(9==
a.theTok||!a.isPoint3f(r)){y=this.getPoint4f(r);if(k)return a.checkLast(a.iToken),this.chk||a.runScript(JW.Escape.drawQuat(JU.Quat.newP4(y),null==e?"frame":e," "+l,null==c?new JU.P3:c,n/100)),!1;q="planedef"}else y=c=this.getPoint3f(r,!0),q="coord";r=a.iToken;d=!0;break;case 135267841:case 135266319:if(!d&&!h&&0==E&&135267841!=a.theTok){q="plane";break}b=135266319==a.theTok?a.planeParameter(++r):a.hklParameter(++r);r=a.iToken;if(0!=E){if(this.chk)break;d=this.vwr.getPlaneIntersection(E,b,n/100,0);
n=0;q="polygon";y=d}else y=b,q="planedef";d=!0;break;case 1073742E3:q="lineData";y=a.floatParameterSet(++r,0,2147483647);r=a.iToken;d=!0;break;case 10:case 1048577:q="atomSet";y=this.atomExpressionAt(r);k&&(c=this.centerParameter(r));r=a.iToken;d=!0;break;case 7:q="modelBasedPoints";y=J.script.SV.listValue(a.theToken);d=!0;break;case 1073742195:case 269484080:break;case 269484096:y=a.xypParameter(r);if(null!=y){r=a.iToken;q="coord";d=!0;break}g&&this.invArg();g=!0;break;case 269484097:g||this.invArg();
g=!1;break;case 1141899269:q="reverse";break;case 4:y=this.stringParameter(r);q="title";break;case 135198:q="vector";break;case 1141899267:y=Float.$valueOf(this.floatParameter(++r));q="length";break;case 3:y=Float.$valueOf(this.floatParameter(r));q="length";break;case 1095761935:q="modelIndex";y=Integer.$valueOf(this.intParameter(++r));break;case 2:g?(q="modelIndex",y=Integer.$valueOf(this.intParameter(r))):n=this.intParameter(r);break;case 1073742138:++r>=this.slen&&this.error(34);switch(this.getToken(r).tok){case 2:n=
this.intParameter(r);continue;case 3:n=Math.round(100*this.floatParameter(r));continue}this.error(34);break;case 1074790550:e=this.setShapeId(22,++r,b);z=null==this.getShapeProperty(22,"ID");r=a.iToken;break;case 1073742027:q="fixed";y=Boolean.FALSE;break;case 1060869:q="fixed";y=Boolean.TRUE;break;case 1073742066:b=this.getPoint3f(++r,!0);r=a.iToken;q="offset";y=b;break;case 1073741906:q="crossed";break;case 1073742196:y=Float.$valueOf(this.floatParameter(++r));q="width";l=q+" "+y;break;case 1073741998:q=
"line";y=Boolean.TRUE;break;case 1073741908:q="curve";break;case 1074790416:q="arc";break;case 1073741846:q="arrow";break;case 1073741880:q="circle";break;case 1073741912:q="cylinder";break;case 1073742194:q="vertices";break;case 1073742048:q="nohead";break;case 1073741861:q="isbarb";break;case 1073742130:q="rotate45";break;case 1073742092:q="perp";break;case 1666189314:case 1073741916:l=1666189314==a.theTok;F=this.floatParameter(++r);l&&(F*=2);y=Float.$valueOf(F);q=l||3==this.tokAt(r)?"width":"diameter";
l=q+(3==this.tokAt(r)?" "+F:" "+K(F));break;case 1048582:if(269484096==this.tokAt(r+2)||k){d=c=this.centerParameter(r);r=a.iToken;q="coord";y=d;d=!0;break}y=a.objectNameParameter(++r);q="identifier";d=!0;break;case 1766856708:case 603979967:case 1073742074:b=!0;s=this.getColorTrans(a,r,!1,t);r=a.iToken;continue;default:if(!a.setMeshDisplayProperty(22,0,a.theTok)){if(269484209==a.theTok||J.script.T.tokAttr(a.theTok,1073741824)){e=this.setShapeId(22,r,b);r=a.iToken;break}this.invArg()}0==m&&(m=r);r=
a.iToken;continue}b=12291!=a.theTok;d&&(!f&&!k)&&(this.setShapeProperty(22,"points",Integer.$valueOf(n)),f=!0,n=0);d&&z&&this.invArg();null!=q&&this.setShapeProperty(22,q,y)}this.finalizeObject(22,t[0],s,n,d,C,m,null);return!0});l(c$,"data",function(){var a=this.e,b=null,c=null,e=!1,d;switch(a.iToken=this.slen){case 5:b=this.paramAsStr(2);case 4:case 2:c=this.paramAsStr(1);if(c.equalsIgnoreCase("clear")){this.chk||this.vwr.setData(null,null,0,0,0,0,0);return}if(0<=(d=c.indexOf("@")))b=""+a.getParameter(c.substring(d+
1),4),c=c.substring(0,d).trim();else if(null==b&&0<=(d=c.indexOf(" ")))b=c.substring(d+1).trim(),c=c.substring(0,d).trim(),e=!0;break;default:a.bad()}d=c+" ";d=d.substring(0,d.indexOf(" ")).toLowerCase();if(d.equals("model")||d.equals("append"))a.cmdLoad();else if(!this.chk){var f=0<=c.toLowerCase().indexOf("(default)");if(d.equals("connect_atoms"))this.vwr.connect(this.parseDataArray(b,!1));else if(0==d.indexOf("ligand_"))this.vwr.setLigandModel(c.substring(7).toUpperCase()+"_data",b.trim());else if(0==
d.indexOf("file_"))this.vwr.setLigandModel(c.substring(5).toUpperCase()+"_file",b.trim());else if(a=this.lastData=Array(4),d.equals("element_vdw")){a[0]=d;a[1]=b.$replace(";","\n");b=JW.Elements.elementNumberMax;d=X(b+1,0);for(f=1;f<=b;f++)d[f]=f;a[2]=d;a[3]=Integer.$valueOf(0);this.vwr.setData("element_vdw",a,b,0,0,0,0)}else if(0==d.indexOf("data2d_"))a[0]=c,a[1]=this.parseDataArray(b,!1),a[3]=Integer.$valueOf(2),this.vwr.setData(c,a,0,0,0,0,0);else if(0==d.indexOf("data3d_"))a[0]=c,a[1]=this.parseDataArray(b,
!0),a[3]=Integer.$valueOf(3),this.vwr.setData(c,a,0,0,0,0,0);else{var g=JU.PT.getTokens(c);if(0==d.indexOf("property_")&&!(2==g.length&&g[1].equals("set"))){f=this.vwr.getSelectedAtoms();a[0]=d;var h=e?0:this.vwr.getParameter("propertyAtomNumberField").intValue(),k=e?0:this.vwr.getParameter("propertyAtomNumberColumnCount").intValue(),E=e?-2147483648:this.vwr.getParameter("propertyDataField").intValue(),s=e?0:this.vwr.getParameter("propertyDataColumnCount").intValue();!e&&0<=c.indexOf(" ")&&(3==g.length&&
(h=JU.PT.parseInt(g[1]),E=JU.PT.parseInt(g[2])),5==g.length&&(h=JU.PT.parseInt(g[1]),k=JU.PT.parseInt(g[2]),E=JU.PT.parseInt(g[3]),s=JU.PT.parseInt(g[4])));0>h&&(h=0);0>E&&(E=0);c=this.vwr.getAtomCount();e=null;g=JU.BS.newN(c);if(0<h){for(var e=X(c+2,0),t=0;t<=c;t++)e[t]=-1;for(t=f.nextSetBit(0);0<=t;t=f.nextSetBit(t+1)){var n=this.vwr.getAtomNumber(t);n>c+1||(0>n||g.get(n))||(g.set(n),e[n]=t)}a[2]=e}else a[2]=JW.BSUtil.copy(f);a[1]=b;a[3]=Integer.$valueOf(0);this.vwr.setData(d,a,c,h,k,E,s)}else h=
JM.AtomCollection.getUserSettableType(d),0<=h?this.vwr.setAtomData(h,d,b,f):(a[0]=c,a[1]=b,a[3]=Integer.$valueOf(0),this.vwr.setData(d,a,0,0,0,0,0))}}});l(c$,"ellipsoid",function(){var a=this.e,b=0,c=1,e=3.4028235E38,d=!1,f=!1;this.setShapeProperty(20,"thisID",null);switch(this.getToken(1).tok){case 1048589:b=2147483647;break;case 1048588:break;case 2:b=this.intParameter(1);break;case 1085443:this.sm.loadShape(20);this.setShapeProperty(20,"select",this.paramAsStr(2));c=a.iToken;f=d=!0;break;case 1074790550:case 269484209:case 1073741824:this.sm.loadShape(20);
1074790550==a.theTok&&c++;this.setShapeId(20,c,!1);c=a.iToken;d=!0;break;default:this.invArg()}if(d){for(b=[-2147483648];++c<this.slen;){var d=this.paramAsStr(c),g=null;this.getToken(c);if(!f)switch(a.theTok){case 1048582:d="points";g=Array(3);g[0]=a.objectNameParameter(++c);if(this.chk)continue;a.getShapePropertyData(24,"getVertices",g);break;case 1611272194:for(var g=Array(3),h=0;3>h;h++)g[h]=new JU.V3,g[h].setT(this.centerParameter(++c)),c=a.iToken;break;case 12289:g=this.centerParameter(++c);
c=a.iToken;break;case 1095761935:g=Integer.$valueOf(this.intParameter(++c));break;case 12291:g=Boolean.TRUE,this.checkLength(c+1)}if(null==g)switch(a.theTok){case 1048589:d="on";g=Boolean.TRUE;break;case 1048588:d="on";g=Boolean.FALSE;break;case 1073742138:g=Float.$valueOf(this.floatParameter(++c));break;case 10:case 1048577:d="atoms";g=this.atomExpressionAt(c);c=a.iToken;break;case 1766856708:case 603979967:case 1073742074:e=this.getColorTrans(a,c,!0,b);c=a.iToken;continue;case 1073742075:g=this.paramAsStr(++c)}null==
g&&this.invArg();this.setShapeProperty(20,d.toLowerCase(),g)}this.finalizeObject(20,b[0],e,0,!1,null,0,null);this.setShapeProperty(20,"thisID",null)}else a.setShapeSizeBs(20,b,null)});l(c$,"isosurface",function(a){var b=this.e;this.sm.loadShape(a);if(1073742001==this.tokAt(1)&&this.listIsosurface(a))return!1;var c=0,e=24==a,d=28==a,f=29==a,g=26==a,h=!1,k=!1,E=!1,s=!1,t=!1,n=!1,l=!1,m=!1,z=!1,C=!1,G=!1,r=!1,q=!1,y=!1,x=null,u=null,I=-2147483648,D,F,S,M,v,T=NaN,P=NaN,ib=0,X=null,da=2147483647,N=null,
Q=null,$=null,p=new JU.SB,L,ua=null,Qa=null,na,ea=0,aa=null,R=this.chk?0:-2147483648;b.setCursorWait(!0);var la=null!=this.initIsosurface(a),jb=la&&null==this.getShapeProperty(a,"ID"),kb=!1,Ra=!1,va=null,Sa=null,fa=null,Ta=null,ra=null,wa=null,B=new JU.List,lb=!1;(d||f)&&this.addShapeProperty(B,"fileType","Pmesh");for(var j=b.iToken;j<this.slen;++j){var A=null,w=null;this.getToken(j);1073741824==b.theTok&&(aa=this.paramAsStr(j));switch(b.theTok){case 603979871:X=1048589==this.getToken(++j).tok?Boolean.TRUE:
1048588==b.theTok?Boolean.FALSE:null;null==X&&this.invArg();continue;case 553648149:da=this.intParameter(++j);continue;case 4128:A="moveIsosurface";12!=this.tokAt(++j)&&this.invArg();w=this.getToken(j++).value;break;case 1297090050:for(var mb=this.floatArraySet(j+2,this.intParameter(j+1),16),ra=Array(mb.length),ga=ra.length;0<=--ga;)ra[ga]=JU.M4.newA16(mb[ga]);j=b.iToken;break;case 1089470478:0>R&&(R=Math.min(this.vwr.getCurrentModelIndex(),0));var nb=null==$;null==Q&&(Q=JW.BSUtil.copy(this.vwr.getSelectedAtoms()));
Q.and(this.vwr.getAtomBits(1297090050,Integer.$valueOf(1)));nb||Q.andNot($);this.addShapeProperty(B,"select",Q);nb&&($=JW.BSUtil.copy(Q),JW.BSUtil.invertInPlace($,this.vwr.getAtomCount()),y=!0,this.addShapeProperty(B,"ignore",$),p.append(" ignore ").append(JW.Escape.eBS($)));p.append(" symmetry");0==ea&&this.addShapeProperty(B,"colorRGB",Integer.$valueOf(1297090050));ra=this.vwr.ms.getSymMatrices(R);break;case 1073742066:A="offset";w=this.centerParameter(++j);j=b.iToken;break;case 528432:A="rotate";
w=1048587==this.tokAt(b.iToken=++j)?null:this.getPoint4f(j);j=b.iToken;break;case 1610612740:A="scale3d";w=Float.$valueOf(this.floatParameter(++j));break;case 1073742090:p.append(" periodic");A="periodic";break;case 1073742078:case 266298:case 135266320:A=b.theToken.value.toString();p.append(" ").appendO(b.theToken.value);w=this.centerParameter(++j);p.append(" ").append(JW.Escape.eP(w));j=b.iToken;break;case 1679429641:if(0<=this.fullCommand.indexOf("# BBOX=")){var ob=JU.PT.split(JU.PT.getQuotedAttribute(this.fullCommand,
"# BBOX"),",");na=[JW.Escape.uP(ob[0]),JW.Escape.uP(ob[1])]}else b.isCenterParameter(j+1)?(na=[this.getPoint3f(j+1,!0),this.getPoint3f(b.iToken+1,!0)],j=b.iToken):na=this.vwr.getBoundBoxVertices();p.append(" boundBox "+JW.Escape.eP(na[0])+" "+JW.Escape.eP(na[na.length-1]));A="boundingBox";w=na;break;case 135188:d=!0;p.append(" pmesh");A="fileType";w="Pmesh";break;case 135267842:Q=this.atomExpressionAt(++j);this.chk?N=new JU.BS:1048577==this.tokAt(b.iToken+1)||10==this.tokAt(b.iToken+1)?(N=this.atomExpressionAt(++b.iToken),
N.and(this.vwr.getAtomsWithinRadius(5,Q,!1,null))):(N=this.vwr.getAtomsWithinRadius(5,Q,!0,null),N.andNot(this.vwr.getAtomBits(1095761936,Q)));N.andNot(Q);p.append(" intersection ").append(JW.Escape.eBS(Q)).append(" ").append(JW.Escape.eBS(N));j=b.iToken;if(135368713==this.tokAt(j+1)){j++;var xa=this.getToken(++j).value;p.append(" function ").append(JU.PT.esc(xa));this.chk||this.addShapeProperty(B,"func",xa.equals("a+b")||xa.equals("a-b")?xa:this.createFunction("__iso__","a,b",xa))}else q=!0;A="intersection";
w=[Q,N];break;case 1610625028:case 135266325:var Ua=1610625028==b.theTok;if(Ua){p.append(" display");var c=j,ia=this.tokAt(j+1);if(0==ia)continue;j++;this.addShapeProperty(B,"token",Integer.$valueOf(1048589));if(10==ia||1048579==ia){A="bsDisplay";1048579==ia?p.append(" all"):(w=this.st[j].value,p.append(" ").append(JW.Escape.eBS(w)));b.checkLast(j);break}else 135266325!=ia&&(b.iToken=j,this.invArg())}else ib=j;var Fa,oa=null,N=null,Va=!1;1048577==this.tokAt(j+1)?(Fa=this.floatParameter(j+3),b.isPoint3f(j+
4)?(oa=this.centerParameter(j+4),Va=!0,b.iToken+=2):b.isPoint3f(j+5)?(oa=this.centerParameter(j+5),Va=!0,b.iToken+=2):(N=b.atomExpression(this.st,j+5,this.slen,!0,!1,!1,!0),null==N&&this.invArg())):(Fa=this.floatParameter(++j),oa=this.centerParameter(++j));Ua&&b.checkLast(b.iToken);j=b.iToken;0<=this.fullCommand.indexOf("# WITHIN=")?N=JU.BS.unescape(JU.PT.getQuotedAttribute(this.fullCommand,"# WITHIN")):Va||(N=V(b.expressionResult,JU.BS)?b.expressionResult:null);this.chk||(null!=N&&0<=R&&N.and(this.vwr.getModelUndeletedAtomsBitSet(R)),
null==oa&&(oa=null==N?new JU.P3:this.vwr.getAtomSetCenter(N)),this.getWithinDistanceVector(B,Fa,oa,N,Ua),p.append(" within ").appendF(Fa).append(" ").append(null==N?JW.Escape.eP(oa):JW.Escape.eBS(N)));continue;case 1073742083:var A="parameters",pb=b.floatParameterSet(++j,1,10),j=b.iToken,w=pb;p.append(" parameters ").append(JW.Escape.eAF(pb));break;case 1716520985:case 1073742190:var va=b.theToken.value,Ma=1073742190==b.theTok,ya=this.tokAt(j+1);null==Ta?(!h&&(!E&&!k)&&(this.addShapeProperty(B,"sasurface",
Float.$valueOf(0)),p.append(" vdw"),h=!0),A="property",null==X&&(X=J.script.T.tokAttr(ya,1112539136)&&1==this.vwr.getIsosurfacePropertySmoothing(!1)?Boolean.TRUE:Boolean.FALSE),this.addShapeProperty(B,"propertySmoothing",X),p.append(" isosurfacePropertySmoothing "+X),X===Boolean.TRUE&&(2147483647==da&&(da=this.vwr.getIsosurfacePropertySmoothing(!0)),this.addShapeProperty(B,"propertySmoothingPower",Integer.$valueOf(da)),p.append(" isosurfacePropertySmoothingPower "+da)),this.vwr.g.rangeSelected&&this.addShapeProperty(B,
"rangeSelected",Boolean.TRUE)):A=Ta;aa=this.paramAsStr(j);p.append(" ").append(aa);if(0==aa.toLowerCase().indexOf("property_")){x=O(this.vwr.getAtomCount(),0);if(this.chk)continue;x=this.vwr.getDataFloat(aa);null==x&&this.invArg();this.addShapeProperty(B,A,x);continue}var za=this.vwr.getAtomCount(),x=O(za,0);if(Ma){var qb=this.paramAsStr(++j);0==qb.length?x=b.floatParameterSet(j,za,za):(x=O(za,0),this.chk||JW.Parser.parseStringInfestedFloatArray(""+b.getParameter(qb,4),null,x));this.chk||p.append(' "" ').append(JW.Escape.eAF(x))}else{this.getToken(++j);
if(!this.chk){p.append(" "+b.theToken.value);var Na=this.vwr.ms.at;this.vwr.autoCalculate(ya);if(1766856708!=ya)for(var Wa=za;0<=--Wa;)x[Wa]=JM.Atom.atomPropertyFloat(this.vwr,Na[Wa],ya)}1766856708==ya&&(fa="inherit");if(135266325==this.tokAt(j+1)){var rb=this.floatParameter(j+=2);p.append(" within "+rb);this.addShapeProperty(B,"propertyDistanceMax",Float.$valueOf(rb))}}w=x;break;case 1095761935:case 1095766030:h&&this.invArg();R=1095761935==b.theTok?this.intParameter(++j):b.modelNumberParameter(++j);
p.append(" modelIndex "+R);if(0>R){A="fixed";w=Boolean.TRUE;break}A="modelIndex";w=Integer.$valueOf(R);break;case 135280132:var A="select",Xa=this.atomExpressionAt(++j),w=Xa,j=b.iToken;1073742072==this.tokAt(j+1)&&(j++,$=JW.BSUtil.copy(Xa),JW.BSUtil.invertInPlace($,this.vwr.getAtomCount()),this.addShapeProperty(B,"ignore",$),p.append(" ignore ").append(JW.Escape.eBS($)),y=!0);h||E?p.append(" select "+JW.Escape.eBS(Xa)):(Q=w,0>R&&0<=Q.nextSetBit(0)&&(R=this.vwr.getAtomModelIndex(Q.nextSetBit(0))));
break;case 1085443:I=this.intParameter(++j);break;case 12289:A="center";w=this.centerParameter(++j);p.append(" center "+JW.Escape.eP(w));j=b.iToken;break;case 1073742147:case 1766856708:var la=!0,Ya=1073742147==b.theTok;if(Ya)p.append(" sign"),this.addShapeProperty(B,"sign",Boolean.TRUE);else{if(1073741914==this.tokAt(j+1)){j++;A="colorDensity";p.append(" color density");if(this.isFloatParameter(j+1)){var sb=this.floatParameter(++j);p.append(" "+sb);w=Float.$valueOf(sb)}break}if(4==this.getToken(j+
1).tok)fa=this.paramAsStr(++j),0<fa.indexOf(" ")&&(wa=JW.C.getColixArray(fa),null==wa&&this.error(4));else if(1073742018==b.theTok){j++;p.append(" color mesh");ea=b.getArgbParam(++j);this.addShapeProperty(B,"meshcolor",Integer.$valueOf(ea));p.append(" ").append(JW.Escape.escapeColor(ea));j=b.iToken;continue}if(603979967==(b.theTok=this.tokAt(j+1))||1073742074==b.theTok){p.append(" color");Sa=this.setColorOptions(p,j+1,24,-2);j=b.iToken;continue}switch(this.tokAt(j+1)){case 1073741826:case 1073742114:this.getToken(++j);
p.append(" color range");this.addShapeProperty(B,"rangeAll",null);if(1048579==this.tokAt(j+1)){j++;p.append(" all");continue}var tb=this.floatParameter(++j),ub=this.floatParameter(++j);this.addShapeProperty(B,"red",Float.$valueOf(tb));this.addShapeProperty(B,"blue",Float.$valueOf(ub));p.append(" ").appendF(tb).append(" ").appendF(ub);continue}if(b.isColorParam(j+1)&&(ea=b.getArgbParam(j+1),1074790746==this.tokAt(j+2))){fa=b.getColorRange(j+1);j=b.iToken;break}p.append(" color")}b.isColorParam(j+1)?
(ea=b.getArgbParam(++j),p.append(" ").append(JW.Escape.escapeColor(ea)),j=b.iToken,this.addShapeProperty(B,"colorRGB",Integer.$valueOf(ea)),la=!0,b.isColorParam(j+1)?(ea=b.getArgbParam(++j),j=b.iToken,this.addShapeProperty(B,"colorRGB",Integer.$valueOf(ea)),p.append(" ").append(JW.Escape.escapeColor(ea)),s=!0):Ya&&this.invPO()):!Ya&&null==wa&&this.invPO();continue;case 135270423:e||this.invArg();C=!this.chk;continue;case 1229984263:4!=this.tokAt(j+1)&&this.invPO();continue;case 1112541195:case 1649412120:p.append(" ").appendO(b.theToken.value);
var Aa=b.encodeRadiusParameter(j,!1,!0);if(null==Aa)return!1;p.append(" ").appendO(Aa);Float.isNaN(Aa.value)&&(Aa.value=100);w=Aa;A="radius";z=!0;E&&(h=!1);j=b.iToken;break;case 135266319:k=!0;A="plane";w=b.planeParameter(++j);j=b.iToken;p.append(" plane ").append(JW.Escape.eP4(w));break;case 1073742138:A="scale";w=Float.$valueOf(this.floatParameter(++j));p.append(" scale ").appendO(w);break;case 1048579:la&&this.invArg();A="thisID";break;case 1113198596:h=!0;++j;w=this.getPoint4f(j);A="ellipsoid";
j=b.iToken;p.append(" ellipsoid ").append(JW.Escape.eP4(w));break;case 135267841:k=!0;A="plane";w=b.hklParameter(++j);j=b.iToken;p.append(" plane ").append(JW.Escape.eP4(w));break;case 135182:var h=!0,Ga=this.paramAsStr(++j);this.addShapeProperty(B,"lcaoType",Ga);p.append(" lcaocartoon ").append(JU.PT.esc(Ga));switch(this.getToken(++j).tok){case 10:case 1048577:A="lcaoCartoon";N=this.atomExpressionAt(j);j=b.iToken;if(this.chk)continue;var Ba=N.nextSetBit(0);0>Ba&&this.error(14);p.append(" ({").appendI(Ba).append("})");
R=this.vwr.getAtomModelIndex(Ba);this.addShapeProperty(B,"modelIndex",Integer.$valueOf(R));var Za=[new JU.V3,new JU.V3,JU.V3.newV(this.vwr.getAtomPoint3f(Ba)),new JU.V3];if(!Ga.equalsIgnoreCase("s")&&null==this.vwr.getHybridizationAndAxes(Ba,Za[0],Za[1],Ga))return!1;w=Za;break;default:this.error(14)}break;case 1183762:var Ca=2147483647,sa=2147483647,$a=269484192==this.tokAt(j+1);$a&&j++;var Da=null;switch(this.tokAt(++j)){case 0:b.bad();break;case 1073741914:p.append("mo [1] squared ");this.addShapeProperty(B,
"squareLinear",Boolean.TRUE);Da=[1];sa=Ca=0;j++;break;case 1073741973:case 1073742008:sa=this.moOffset(j);Ca=0;j=b.iToken;p.append(" mo "+($a?"-":"")+"HOMO ");0<sa&&p.append("+");0!=sa&&p.appendI(sa);break;case 2:Ca=this.intParameter(j);p.append(" mo ").appendI(Ca);break;default:b.isArrayParameter(j)&&(Da=b.floatParameterSet(j,1,2147483647),j=b.iToken)}if(1073742156==this.tokAt(j+1))this.addShapeProperty(B,"squareLinear",Boolean.TRUE),p.append(" squared"),null==Da&&(Da=O(0,0));else if(135266320==
this.tokAt(j+1)){++j;var vb=this.intParameter(++j),wb=2==this.tokAt(j+1)?this.intParameter(++j):-System.currentTimeMillis()%1E4;this.addShapeProperty(B,"monteCarloCount",Integer.$valueOf(vb));this.addShapeProperty(B,"randomSeed",Integer.$valueOf(wb));p.append(" points ").appendI(vb).appendC(" ").appendI(wb)}this.setMoData(B,Ca,Da,sa,$a,R,null);h=!0;continue;case 1073742036:A="nci";p.append(" "+A);var ia=this.tokAt(j+1),xb=1229984263!=ia&&4!=ia&&1073742033!=ia,w=Boolean.$valueOf(xb);xb&&(h=!0);break;
case 1073742016:case 1073742022:var yb=1073742016==b.theTok,A=yb?"mep":"mlp";p.append(" "+A);var Ha=null,ab=-1,h=!0;2==this.tokAt(j+1)&&(ab=this.intParameter(++j),p.append(" "+ab),this.addShapeProperty(B,"mepCalcType",Integer.$valueOf(ab)));if(4==this.tokAt(j+1))Ha=this.stringParameter(++j),p.append(" /*file*/"+JU.PT.esc(Ha));else if(1716520985==this.tokAt(j+1)){Ta=A;continue}if(!this.chk)try{x=null==Ha&&yb?this.vwr.getPartialCharges():this.getAtomicPotentials(Q,$,Ha)}catch(zb){if(!ca(zb,Exception))throw zb;
}!this.chk&&null==x&&this.error(32);w=x;break;case 1313866249:l=!this.chk;p.append(" volume");break;case 1074790550:this.setShapeId(a,++j,la);jb=null==this.getShapeProperty(a,"ID");j=b.iToken;break;case 1073741888:603979967==this.tokAt(j+1)&&(kb=!0,j++);fa=this.paramAsStr(++j).toLowerCase();fa.equals("sets")?p.append(' colorScheme "sets"'):b.isColorParam(j)&&(fa=b.getColorRange(j),j=b.iToken);break;case 1073741828:A="addHydrogens";w=Boolean.TRUE;p.append(" mp.addHydrogens");break;case 1073741836:A=
"angstroms";p.append(" angstroms");break;case 1073741838:A="anisotropy";w=this.getPoint3f(++j,!1);p.append(" anisotropy").append(JW.Escape.eP(w));j=b.iToken;break;case 1073741842:n=!this.chk;p.append(" area");break;case 1073741850:case 1073742076:h=!0;s&&!t&&(p.append(' phase "_orb"'),this.addShapeProperty(B,"phase","_orb"));var Y=O(7,0);Y[0]=this.intParameter(++j);Y[1]=this.intParameter(++j);Y[2]=this.intParameter(++j);Y[3]=this.isFloatParameter(j+1)?this.floatParameter(++j):6;p.append(" atomicOrbital ").appendI(K(Y[0])).append(" ").appendI(K(Y[1])).append(" ").appendI(K(Y[2])).append(" ").appendF(Y[3]);
135266320==this.tokAt(j+1)&&(j+=2,Y[4]=this.intParameter(j),Y[5]=3==this.tokAt(j+1)?this.floatParameter(++j):0,Y[6]=2==this.tokAt(j+1)?this.intParameter(++j):-System.currentTimeMillis()%1E4,p.append(" points ").appendI(K(Y[4])).appendC(" ").appendF(Y[5]).appendC(" ").appendI(K(Y[6])));A="hydrogenOrbital";w=Y;break;case 1073741866:p.append(" binary");continue;case 1073741868:p.append(" blockData");A="blockData";w=Boolean.TRUE;break;case 1074790451:case 554176565:r=!0;A=b.theToken.value;w=this.getCapSlabObject(j,
!1);j=b.iToken;break;case 1073741876:e||this.invArg();m=!0;if(this.chk)continue;var Ab=this.isFloatParameter(j+1)?this.floatParameter(++j):1.2,bb=this.isFloatParameter(j+1)?this.floatParameter(++j):10;if(10<bb)return b.integerOutOfRange(0,10),!1;p.append(" cavity ").appendF(Ab).append(" ").appendF(bb);this.addShapeProperty(B,"envelopeRadius",Float.$valueOf(bb));this.addShapeProperty(B,"cavityRadius",Float.$valueOf(Ab));A="cavity";break;case 1073741896:case 1073741900:A="contour";p.append(" contour");
switch(this.tokAt(j+1)){case 1073741920:w=b.floatParameterSet(j+2,1,2147483647);p.append(" discrete ").append(JW.Escape.eAF(w));j=b.iToken;break;case 1073741981:L=this.getPoint3f(j+2,!1);(0>=L.z||L.y<L.x)&&this.invArg();L.z==K(L.z)&&L.z>L.y-L.x&&(L.z=(L.y-L.x)/L.z);w=L;j=b.iToken;p.append(" increment ").append(JW.Escape.eP(L));break;default:w=Integer.$valueOf(2==this.tokAt(j+1)?this.intParameter(++j):0),p.append(" ").appendO(w)}break;case 3:case 2:case 269484193:case 1073741910:p.append(" cutoff ");
1073741910==b.theTok&&j++;269484193==this.tokAt(j)?(A="cutoffPositive",w=Float.$valueOf(P=this.floatParameter(++j)),p.append("+").appendO(w)):this.isFloatParameter(j)?(A="cutoff",w=Float.$valueOf(P=this.floatParameter(j)),p.appendO(w)):(A="cutoffRange",w=b.floatParameterSet(j,2,2),this.addShapeProperty(B,"cutoff",Float.$valueOf(0)),p.append(JW.Escape.eAF(w)),j=b.iToken);break;case 1073741928:A="downsample";w=Integer.$valueOf(this.intParameter(++j));p.append(" downsample ").appendO(w);break;case 1073741930:A=
"eccentricity";w=this.getPoint4f(++j);p.append(" eccentricity ").append(JW.Escape.eP4(w));j=b.iToken;break;case 1074790508:p.append(" ed");this.setMoData(B,-1,null,0,!1,R,null);h=!0;continue;case 536870916:case 1073742041:p.append(" ").appendO(b.theToken.value);A="debug";w=536870916==b.theTok?Boolean.TRUE:Boolean.FALSE;break;case 1060869:p.append(" fixed");A="fixed";w=Boolean.TRUE;break;case 1073741962:p.append(" fullPlane");A="fullPlane";w=Boolean.TRUE;break;case 1073741966:case 1073741968:var Oa=
1073741968==b.theTok,A=""+b.theToken.value,ja=new JU.List,w=ja,G=h=!0;p.append(" ").append(A);var Z=this.paramAsStr(++j);if(Z.equals("=")){p.append(" =");Z=this.paramAsStr(++j);p.append(" ").append(JU.PT.esc(Z));ja.addLast(Z);this.chk||this.addShapeProperty(B,"func",this.createFunction("__iso__","x,y,z",Z));break}var cb=JU.PT.getQuotedAttribute(this.fullCommand,"# DATA"+(G?"2":""));null==cb?cb="inline":Z=cb;var Bb=0==Z.indexOf("data2d_"),Pa=0==Z.indexOf("data3d_"),Ra=Z.equals("inline");p.append(" inline");
ja.addLast(Z);var Cb=this.getPoint3f(++j,!1);p.append(" ").append(JW.Escape.eP(Cb));ja.addLast(Cb);var ka;M=++b.iToken;ja.addLast(ka=this.getPoint4f(M));p.append(" ").append(JW.Escape.eP4(ka));D=K(ka.x);v=++b.iToken;ja.addLast(ka=this.getPoint4f(v));p.append(" ").append(JW.Escape.eP4(ka));F=K(ka.x);ja.addLast(ka=this.getPoint4f(++b.iToken));p.append(" ").append(JW.Escape.eP4(ka));S=K(ka.x);(0==D||0==F||0==S)&&this.invArg();if(!this.chk){var ba=null,ha=null;if(Oa){Ra?(D=Math.abs(D),F=Math.abs(F),S=
Math.abs(S),ha=this.floatArraySetXYZ(++b.iToken,D,F,S)):ha=Pa?this.vwr.getDataFloat3D(Z):this.vwr.functionXYZ(Z,D,F,S);D=Math.abs(D);F=Math.abs(F);S=Math.abs(S);null==ha&&(b.iToken=M,b.errorStr(53,"xyzdata is null."));if(ha.length!=D||ha[0].length!=F||ha[0][0].length!=S)b.iToken=M,b.errorStr(53,"xyzdata["+ha.length+"]["+ha[0].length+"]["+ha[0][0].length+"] is not of size ["+D+"]["+F+"]["+S+"]");ja.addLast(ha);p.append(" ").append(JW.Escape.e(ha))}else{Ra?(D=Math.abs(D),F=Math.abs(F),ba=this.floatArraySet(++b.iToken,
D,F)):Bb?(ba=this.vwr.getDataFloat2D(Z),D=null==ba?0:ba.length,F=3):(ba=this.vwr.functionXY(Z,D,F),D=Math.abs(D),F=Math.abs(F));null==ba&&(b.iToken=M,b.errorStr(53,"fdata is null."));ba.length!=D&&!Bb&&(b.iToken=M,b.errorStr(53,"fdata length is not correct: "+ba.length+" "+D+"."));for(ga=0;ga<D;ga++)null==ba[ga]&&(b.iToken=v,b.errorStr(53,"fdata["+ga+"] is null.")),ba[ga].length!=F&&(b.iToken=v,b.errorStr(53,"fdata["+ga+"] is not the right length: "+ba[ga].length+" "+F+"."));ja.addLast(ba);p.append(" ").append(JW.Escape.e(ba))}}j=
b.iToken;break;case 1073741970:A="gridPoints";p.append(" gridPoints");break;case 1073741976:A="ignore";w=$=this.atomExpressionAt(++j);p.append(" ignore ").append(JW.Escape.eBS($));j=b.iToken;break;case 1073741984:A="insideOut";p.append(" insideout");break;case 1073741988:case 1073741986:case 1073742100:p.append(" ").appendO(b.theToken.value);A="pocket";w=1073742100==b.theTok?Boolean.TRUE:Boolean.FALSE;break;case 1073742002:A="lobe";w=this.getPoint4f(++j);j=b.iToken;p.append(" lobe ").append(JW.Escape.eP4(w));
h=!0;break;case 1073742004:case 1073742006:A="lp";w=this.getPoint4f(++j);j=b.iToken;p.append(" lp ").append(JW.Escape.eP4(w));h=!0;break;case 1052700:(E||this.slen==j+1)&&this.invArg();E=!0;if((m||z||q)&&!h)h=!0,this.addShapeProperty(B,"bsSolvent",z||q?new JU.BS:b.lookupIdentifierValue("solvent")),this.addShapeProperty(B,"sasurface",Float.$valueOf(0));0==p.length()?(ua=this.getShapeProperty(24,"plane"),null==ua?null!=this.getShapeProperty(24,"contours")&&this.addShapeProperty(B,"nocontour",null):
(this.addShapeProperty(B,"plane",ua),p.append("plane ").append(JW.Escape.eP4(ua)),k=!0,ua=null)):!h&&!k&&this.invArg();p.append("; isosurface map");this.addShapeProperty(B,"map",h?Boolean.TRUE:Boolean.FALSE);break;case 1073742014:A="maxset";w=Integer.$valueOf(this.intParameter(++j));p.append(" maxSet ").appendO(w);break;case 1073742020:A="minset";w=Integer.$valueOf(this.intParameter(++j));p.append(" minSet ").appendO(w);break;case 1073742112:h=!0;A="rad";w=this.getPoint4f(++j);j=b.iToken;p.append(" radical ").append(JW.Escape.eP4(w));
break;case 1073742027:A="fixed";w=Boolean.FALSE;p.append(" modelBased");break;case 1073742028:case 1073742135:case 1613758488:var va=b.theToken.value,Ia;1073742028==b.theTok?(A="molecular",p.append(" molecular"),Ia=this.isFloatParameter(j+1)?this.floatParameter(++j):1.4):(this.addShapeProperty(B,"bsSolvent",b.lookupIdentifierValue("solvent")),A=1073742135==b.theTok?"sasurface":"solvent",p.append(" ").appendO(b.theToken.value),Ia=this.isFloatParameter(j+1)?this.floatParameter(++j):this.vwr.getFloat(570425394));
p.append(" ").appendF(Ia);w=Float.$valueOf(Ia);1073741961==this.tokAt(j+1)&&(this.addShapeProperty(B,"doFullMolecular",null),p.append(" full"),j++);h=!0;break;case 1073742033:this.addShapeProperty(B,"fileType","Mrc");p.append(" mrc");continue;case 1073742064:case 1073742062:this.addShapeProperty(B,"fileType","Obj");p.append(" obj");continue;case 1073742034:this.addShapeProperty(B,"fileType","Msms");p.append(" msms");continue;case 1073742094:h&&this.invArg();A="phase";t=!0;w=4==this.tokAt(j+1)?this.stringParameter(++j):
"_orb";p.append(" phase ").append(JU.PT.esc(w));break;case 1073742104:case 1073742122:A="resolution";w=Float.$valueOf(this.floatParameter(++j));p.append(" resolution ").appendO(w);break;case 1073742124:A="reverseColor";w=Boolean.TRUE;p.append(" reversecolor");break;case 1073742146:A="sigma";w=Float.$valueOf(T=this.floatParameter(++j));p.append(" sigma ").appendO(w);break;case 1113198597:A="geodesic";w=Float.$valueOf(this.floatParameter(++j));p.append(" geosurface ").appendO(w);h=!0;break;case 1073742154:A=
"sphere";w=Float.$valueOf(this.floatParameter(++j));p.append(" sphere ").appendO(w);h=!0;break;case 1073742156:A="squareData";w=Boolean.TRUE;p.append(" squared");break;case 1073741983:A=!h&&!k&&!E?"readFile":"mapColor";aa=this.stringParameter(++j);null==aa&&this.invArg();d&&(aa=JU.PT.replaceWithCharacter(aa,"{,}|"," "));b.debugHigh&&JW.Logger.debug("pmesh inline data:\n"+aa);w=this.chk?null:aa;this.addShapeProperty(B,"fileName","");p.append(" INLINE ").append(JU.PT.esc(aa));h=!0;break;case 4:var Ja=
!h&&!k,A=Ja&&!E?"readFile":"mapColor",W=this.paramAsStr(j);if(W.startsWith("=")&&1<W.length){var db=this.vwr.setLoadFormat(W,"_",!1),W=db[0],Db=!Ja||!Float.isNaN(P)?null:db[1];if(null!=Db&&!this.chk){P=NaN;try{var Ka=this.vwr.getFileAsString(Db,!1);JW.Logger.info(Ka);Ka=JU.PT.split(Ka,"MAP_SIGMA_DENS")[1];P=JU.PT.parseFloat(Ka);JW.Logger.info("using cutoff = "+P)}catch(Eb){if(ca(Eb,Exception))JW.Logger.error("MAP_SIGMA_DENS -- could  not read "+db[1]);else throw Eb;}0<P&&(Float.isNaN(T)||(P*=T,T=
NaN,this.addShapeProperty(B,"sigma",Float.$valueOf(T))),this.addShapeProperty(B,"cutoff",Float.$valueOf(P)),p.append(" cutoff ").appendF(P))}0==ib&&(va="=xxxx",0>R&&(R=this.vwr.getCurrentModelIndex()),N=this.vwr.getModelUndeletedAtomsBitSet(R),this.getWithinDistanceVector(B,2,null,N,!1),p.append(" within 2.0 ").append(JW.Escape.eBS(N)));Ja&&(lb=!0)}Ja&&(this.vwr.getParameter("_fileType").equals("Pdb")&&Float.isNaN(T)&&Float.isNaN(P))&&(this.addShapeProperty(B,"sigma",Float.$valueOf(-1)),p.append(" sigma -1.0"));
0==W.length&&(0>R&&(R=this.vwr.getCurrentModelIndex()),W=b.getFullPathName(),w=this.vwr.getModelAuxiliaryInfoValue(R,"jmolSurfaceInfo"));var eb=-1;null==w&&2==this.tokAt(j+1)&&this.addShapeProperty(B,"fileIndex",Integer.$valueOf(eb=this.intParameter(++j)));var Ea=4==this.tokAt(j+1)?this.stringParameter(++j):null,h=!0;if(this.chk)break;var ta,ma=null;null==w&&(0<=this.fullCommand.indexOf("# FILE0=")?(W=JU.PT.getQuotedAttribute(this.fullCommand,"# FILE0"),1073741848==this.tokAt(j+1)&&(j+=2)):1073741848==
this.tokAt(j+1)&&(ma=this.vwr.getFilePath(this.stringParameter(b.iToken=j+=2),!1),ta=this.vwr.getFullPathNameOrError(ma),ma=ta[0],""!==this.vwr.getPathForAllFiles()?(W=ma,ma=null):this.addShapeProperty(B,"localName",ma)));!W.startsWith("cache://")&&null==Ea&&(ta=this.vwr.getFullPathNameOrError(W),W=ta[0],null!=ta[1]&&b.errorStr(17,W+":"+ta[1]));JW.Logger.info("reading isosurface data from "+W);null!=Ea&&(w=this.vwr.cacheGet(W),this.addShapeProperty(B,"calculationType",Ea));null==w&&(this.addShapeProperty(B,
"fileName",W),null!=ma&&(W=ma),0<=eb&&p.append(" ").appendI(eb));p.append(" /*file*/").append(JU.PT.esc(W));null!=Ea&&p.append(" ").append(JU.PT.esc(Ea));break;case 4106:A="connections";switch(this.tokAt(++j)){case 10:case 1048577:w=[this.atomExpressionAt(j).nextSetBit(0)];break;default:w=[K(b.floatParameterSet(j,1,1)[0])]}j=b.iToken;break;case 1095761923:A="atomIndex";w=Integer.$valueOf(this.intParameter(++j));break;case 1073741999:A="link";p.append(" link");break;case 1073741994:24!=a&&this.invArg();
L=this.getPoint3f(b.iToken+1,!1);j=b.iToken;if(0>=L.x||0>=L.y||0>=L.z)break;L.x=K(L.x);L.y=K(L.y);L.z=K(L.z);p.append(" lattice ").append(JW.Escape.eP(L));E?(A="mapLattice",w=L):Qa=L;break;default:1073741824==b.theTok&&(A="thisID",w=aa);if(!b.setMeshDisplayProperty(a,0,b.theTok)){if(J.script.T.tokAttr(b.theTok,1073741824)&&!la){this.setShapeId(a,j,la);j=b.iToken;break}this.invArg()}0==c&&(c=j);j=this.slen-1}la=12291!=b.theTok;jb&&h&&this.invArg();null!=A&&this.addShapeProperty(B,A,w)}if(!this.chk){if((m||
z)&&!h)h=!0,this.addShapeProperty(B,"bsSolvent",z?new JU.BS:b.lookupIdentifierValue("solvent")),this.addShapeProperty(B,"sasurface",Float.$valueOf(0));k&&(!h&&!E)&&(this.addShapeProperty(B,"nomap",Float.$valueOf(0)),h=!0);-1<=I&&this.addShapeProperty(B,"getSurfaceSets",Integer.$valueOf(I-1));if(null!=wa)this.addShapeProperty(B,"colorDiscrete",wa);else if("sets".equals(fa))this.addShapeProperty(B,"setColorScheme",null);else if(null!=fa){var La=this.vwr.getColorEncoder(fa);null!=La&&(La.isTranslucent=
kb,La.hi=3.4028235E38,this.addShapeProperty(B,"remapColor",La))}if(h&&!g&&0!=p.indexOf(";")){B.add(0,["newObject",null]);var Fb=null==Q;Fb&&(Q=JW.BSUtil.copy(this.vwr.getSelectedAtoms()));0>R&&(R=this.vwr.getCurrentModelIndex());Q.and(this.vwr.getModelUndeletedAtomsBitSet(R));null!=va&&(1!=this.vwr.getModelBitSet(Q,!1).cardinality()&&b.errorStr(30,"ISOSURFACE "+va),Fb&&(B.add(0,["select",Q]),0==p.indexOf("; isosurface map")&&(p=(new JU.SB).append("; isosurface map select ").append(JW.Escape.eBS(Q)).append(p.substring(16)))))}q&&
!r&&(h||this.addShapeProperty(B,"sasurface",Float.$valueOf(0)),E||(this.addShapeProperty(B,"map",Boolean.TRUE),this.addShapeProperty(B,"select",N),this.addShapeProperty(B,"sasurface",Float.$valueOf(0))),this.addShapeProperty(B,"slab",this.getCapSlabObject(-100,!1)));var Gb=h&&this.vwr.getBoolean(603979934);Gb&&JW.Logger.startTimer("isosurface");this.setShapeProperty(a,"setProperties",B);Gb&&this.showString(JW.Logger.getTimerMsg("isosurface",0));lb&&(this.setShapeProperty(a,"token",Integer.$valueOf(1073742018)),
this.setShapeProperty(a,"token",Integer.$valueOf(1073742046)),y=!0,p.append(" mesh nofill frontOnly"))}null!=Qa&&this.setShapeProperty(a,"lattice",Qa);null!=ra&&this.setShapeProperty(a,"symops",ra);y&&this.setShapeProperty(a,"token",Integer.$valueOf(1073741960));0<c&&(b.setMeshDisplayProperty(a,c,0)||this.invArg());if(this.chk)return!1;var pa=null,qa=null;n&&(pa=this.getShapeProperty(a,"area"),V(pa,Float)?this.vwr.setFloatProperty("isosurfaceArea",pa.floatValue()):this.vwr.setUserVariable("isosurfaceArea",
J.script.SV.getVariableAD(pa)));l&&(qa=l?this.getShapeProperty(a,"volume"):null,V(qa,Float)?this.vwr.setFloatProperty("isosurfaceVolume",qa.floatValue()):this.vwr.setUserVariable("isosurfaceVolume",J.script.SV.getVariableAD(qa)));if(!g){var U=null;if(E&&!h)this.setShapeProperty(a,"finalize",p.toString());else if(h&&(u=p.toString(),this.setShapeProperty(a,"finalize",(0==u.indexOf("; isosurface map")?"":" select "+JW.Escape.eBS(Q)+" ")+u),U=this.getShapeProperty(a,"ID"),null!=U&&!b.tQuiet)){P=this.getShapeProperty(a,
"cutoff").floatValue();Float.isNaN(P)&&!Float.isNaN(T)&&JW.Logger.error("sigma not supported");U+=" created";e&&(U+=" with cutoff="+P);var fb=this.getShapeProperty(a,"minMaxInfo");3.4028235E38!=fb[0]&&(U+=" min="+fb[0]+" max="+fb[1]);U+="; "+JV.JC.shapeClassBases[a].toLowerCase()+" count: "+this.getShapeProperty(a,"count");U+=b.getIsosurfaceDataRange(a,"\n")}var gb,hb;if(n||l)gb=n?"isosurfaceArea = "+(V(pa,Float)?""+pa:JW.Escape.eAD(pa)):null,hb=l?"isosurfaceVolume = "+(V(qa,Float)?""+qa:JW.Escape.eAD(qa)):
null,null==U?(n&&this.showString(gb),l&&this.showString(hb)):(n&&(U+="\n"+gb),l&&(U+="\n"+hb));null!=U&&this.showString(U)}null!=Sa&&this.setShapeProperty(a,"translucency",Sa);this.setShapeProperty(a,"clear",null);C&&this.setShapeProperty(a,"cache",null);26!=a&&this.listIsosurface(a);return!0},"~N");l(c$,"lcaoCartoon",function(){var a=this.e;this.sm.loadShape(26);if(1073742001==this.tokAt(1)&&this.listIsosurface(26))return!1;this.setShapeProperty(26,"init",this.fullCommand);if(1==this.slen)return this.setShapeProperty(26,
"lcaoID",null),!1;for(var b=!1,c=null,c=1;c<this.slen;c++){var e=null,d=null;switch(this.getToken(c).tok){case 1074790451:case 554176565:e=a.theToken.value;1048588==this.tokAt(c+1)&&(a.iToken=c+1);d=this.getCapSlabObject(c,!0);c=a.iToken;break;case 12289:return this.isosurface(26),!1;case 528432:var f=d=0,g=0;switch(this.getToken(++c).tok){case 1112541205:d=0.017453292*this.floatParameter(++c);break;case 1112541206:f=0.017453292*this.floatParameter(++c);break;case 1112541207:g=0.017453292*this.floatParameter(++c);
break;default:this.invArg()}e="rotationAxis";d=JU.V3.new3(d,f,g);break;case 1048589:case 1610625028:case 3145768:e="on";break;case 1048588:case 12294:case 3145770:e="off";break;case 12291:e="delete";break;case 10:case 1048577:e="select";d=this.atomExpressionAt(c);c=a.iToken;break;case 1766856708:c=this.setColorOptions(null,c+1,26,-2);null!=c&&this.setShapeProperty(26,"settranslucency",c);c=a.iToken;b=!0;continue;case 603979967:case 1073742074:a.setMeshDisplayProperty(26,c,a.theTok);c=a.iToken;b=!0;
continue;case 1113200651:case 4:d=this.paramAsStr(c).toLowerCase();d.equals("spacefill")&&(d="cpk");e="create";a.optParameterAsString(c+1).equalsIgnoreCase("molecular")&&(c++,e="molecular");break;case 135280132:10==this.tokAt(c+1)||1048577==this.tokAt(c+1)?(e="select",d=this.atomExpressionAt(c+1),c=a.iToken):(e="selectType",d=this.paramAsStr(++c),d.equals("spacefill")&&(d="cpk"));break;case 1073742138:e="scale";d=Float.$valueOf(this.floatParameter(++c));break;case 1073742004:case 1073742006:e="lonePair";
break;case 1073742112:case 1073742111:e="radical";break;case 1073742028:e="molecular";break;case 1073741904:d=this.paramAsStr(++c);e="create";a.optParameterAsString(c+1).equalsIgnoreCase("molecular")&&(c++,e="molecular");break;case 1074790550:d=a.setShapeNameParameter(++c);c=a.iToken;b&&this.invArg();e="lcaoID";break;default:if(269484209==a.theTok||J.script.T.tokAttr(a.theTok,1073741824))269484209!=a.theTok&&(d=this.paramAsStr(c)),b&&this.invArg(),e="lcaoID"}12291!=a.theTok&&(b=!0);null==e&&this.invArg();
this.setShapeProperty(26,e,d)}this.setShapeProperty(26,"clear",null);return!0});l(c$,"mapProperty",function(){for(var a,b,c,e,d,f=0,g=0,h=0;;){if(1114638363==this.tokAt(1))a=this.vwr.getSelectedAtoms(),b=this.atomExpressionAt(2),c=e="selected";else{a=this.atomExpressionAt(1);if(1048583!=this.tokAt(++this.e.iToken)||!J.script.T.tokAttr(f=this.tokAt(++this.e.iToken),1078984704))break;c=this.paramAsStr(this.e.iToken);b=this.atomExpressionAt(++this.e.iToken);if(1048583!=this.tokAt(++this.e.iToken)||!J.script.T.tokAttr(g=
this.tokAt(++this.e.iToken),2048))break;e=this.paramAsStr(this.e.iToken)}d=J.script.T.tokAttr(h=this.tokAt(this.e.iToken+1),1078984704)?this.paramAsStr(++this.e.iToken):J.script.T.nameOf(h=1095763969);this.e.checkLast(this.e.iToken);if(this.chk)return;var k=null;this.showString("mapping "+c.toUpperCase()+" for "+a.cardinality()+" atoms to "+e.toUpperCase()+" for "+b.cardinality()+" atoms using "+d.toUpperCase());if(J.script.T.tokAttrOr(f,1095761920,1112539136)&&J.script.T.tokAttrOr(g,1095761920,1112539136)&&
J.script.T.tokAttrOr(h,1095761920,1112539136)){var l=this.e.getBitsetPropertyFloat(a,f|224,NaN,NaN),s=this.e.getBitsetPropertyFloat(a,h|224,NaN,NaN),f=this.e.getBitsetPropertyFloat(b,h|224,NaN,NaN),t=1716520985==g,n=O(t?this.vwr.getAtomCount():f.length,0),k=new JU.BS;if(l.length==s.length){for(var H=new java.util.Hashtable,h=0;h<l.length;h++)H.put(Float.$valueOf(s[h]),Float.$valueOf(l[h]));l=-1;for(h=s=0;h<f.length;h++){var l=b.nextSetBit(l+1),m=H.get(Float.$valueOf(f[h]));null!=m&&(k.set(l),n[t?
l:s]=m.floatValue(),s++)}t?this.vwr.setData(e,[e,n,k,Integer.$valueOf(0),Boolean.TRUE],this.vwr.getAtomCount(),0,0,2147483647,0):this.vwr.setAtomProperty(k,g,0,0,null,n,null)}}if(null==k){c=this.getBitsetIdent(a,"{"+d+"=%["+d+"]}."+e+" = %["+c+"]",null,!1,2147483647,!1);a=new JU.SB;for(h=0;h<c.length;h++)0>c[h].indexOf("null")&&a.append(c[h]).appendC("\n");JW.Logger.debugging&&JW.Logger.debug(a.toString());c=JW.BSUtil.copy(this.vwr.getSelectionSubset());this.vwr.setSelectionSubset(b);try{this.e.runScript(a.toString())}catch(z){if(ca(z,
Exception))b=z,this.vwr.setSelectionSubset(c),this.e.errorStr(-1,"Error: "+b.getMessage());else if(ca(z,Error))b=z,this.vwr.setSelectionSubset(c),this.e.errorStr(-1,"Error: "+b.toString());else throw z;}this.vwr.setSelectionSubset(c)}this.showString("DONE");return}this.invArg()});l(c$,"minimize",function(){for(var a=null,b=2147483647,c=0,e=!1,d=!1,f=null,g=!1,h=this.vwr.getMinimizer(!1),k=1;k<this.slen;k++)switch(this.getToken(k).tok){case 1073741828:e=!0;continue;case 1073741874:case 1073742162:this.checkLength(2);
if(this.chk||null==h)return;h.setProperty(this.paramAsStr(k),null);return;case 1073741882:this.checkLength(2);if(this.chk||null==h)return;h.setProperty("clear",null);return;case 1073741894:1!=k&&this.invArg();b=a=0;c=X(5,0);if(1073741882==this.tokAt(++k))this.checkLength(3);else{for(;4>a&&!this.isFloatParameter(k);)c[++a]=this.atomExpressionAt(k).nextSetBit(0),k=this.e.iToken+1;c[0]=a;1==a&&this.invArg();b=this.floatParameter(this.e.checkLast(k))}this.chk||this.vwr.getMinimizer(!0).setProperty("constraint",
[c,X(a,0),Float.$valueOf(b)]);return;case 1073741905:c=this.floatParameter(++k);continue;case 1073741934:b=0;continue;case 1060869:1!=k&&this.invArg();f=this.atomExpressionAt(++k);0>f.nextSetBit(0)&&(f=null);k=this.e.iToken;this.chk||this.vwr.getMinimizer(!0).setProperty("fixed",f);if(k+1==this.slen)return;continue;case 10:case 1048577:g=!0;case 135280132:135280132==this.e.theTok&&k++;a=this.atomExpressionAt(k);k=this.e.iToken;1073742072==this.tokAt(k+1)&&(k++,g=!0);continue;case 1073742148:d=!0;
break;case 266298:b=this.intParameter(++k);continue;default:this.invArg()}this.chk||this.vwr.minimize(b,c,a,f,0,e,g,d,!1)});l(c$,"mo",function(a){var b=this.e,c=2147483647,e=!1,d=this.vwr.getVisibleFramesBitSet(),f=new JU.List,g=1;if(1095766030==this.tokAt(1)||4115==this.tokAt(1))g=b.modelNumberParameter(2),0>g&&this.invArg(),d.clearAll(),d.set(g),g=3;for(var h=d.nextSetBit(0);0<=h;h=d.nextSetBit(h+1)){this.sm.loadShape(27);var k=g;if(1073742001==this.tokAt(k)&&this.listIsosurface(27))break;this.setShapeProperty(27,
"init",Integer.$valueOf(h));var l=null,s=this.getShapeProperty(27,"moNumber").intValue(),t=this.getShapeProperty(27,"moLinearCombination");if(a)break;0==s&&(s=2147483647);var n=null,H=null;switch(this.getToken(k).tok){case 1074790451:case 554176565:n=b.theToken.value;H=this.getCapSlabObject(k,!1);break;case 1073741914:n="squareLinear";H=Boolean.TRUE;t=[1];c=s=0;break;case 2:s=this.intParameter(k);t=this.moCombo(f);null==t&&0>s&&(t=[-100,-s]);break;case 269484192:switch(this.tokAt(++k)){case 1073741973:case 1073742008:break;
default:this.invArg()}e=!0;case 1073741973:case 1073742008:2147483647==(c=this.moOffset(k))&&this.invArg();s=0;t=this.moCombo(f);break;case 1073742037:s=1073742037;t=this.moCombo(f);break;case 1073742108:s=1073742108;t=this.moCombo(f);break;case 1766856708:this.setColorOptions(null,k+1,27,2);break;case 135266319:n="plane";H=b.planeParameter(k+1);break;case 135266320:this.addShapeProperty(f,"randomSeed",2==this.tokAt(k+2)?Integer.$valueOf(this.intParameter(k+2)):null);n="monteCarloCount";H=Integer.$valueOf(this.intParameter(k+
1));break;case 1073742138:n="scale";H=Float.$valueOf(this.floatParameter(k+1));break;case 1073741910:269484193==this.tokAt(k+1)?(n="cutoffPositive",H=Float.$valueOf(this.floatParameter(k+2))):(n="cutoff",H=Float.$valueOf(this.floatParameter(k+1)));break;case 536870916:n="debug";break;case 1073742054:n="plane";break;case 1073742104:case 1073742122:n="resolution";H=Float.$valueOf(this.floatParameter(k+1));break;case 1073742156:n="squareData";H=Boolean.TRUE;break;case 1073742168:k+1<this.slen&&4==this.tokAt(k+
1)&&(n="titleFormat",H=this.paramAsStr(k+1));break;case 1073741824:this.invArg();break;default:if(b.isArrayParameter(k)){t=b.floatParameterSet(k,1,2147483647);1073742156==this.tokAt(b.iToken+1)&&(this.addShapeProperty(f,"squareLinear",Boolean.TRUE),b.iToken++);break}a=b.iToken;b.setMeshDisplayProperty(27,0,b.theTok)||this.invArg();this.setShapeProperty(27,"setProperties",f);b.setMeshDisplayProperty(27,a,this.tokAt(a));return!0}null!=n&&this.addShapeProperty(f,n,H);if(2147483647!=s||null!=t)4==this.tokAt(b.iToken+
1)&&(l=this.paramAsStr(++b.iToken)),b.setCursorWait(!0),this.setMoData(f,s,t,c,e,h,l),this.addShapeProperty(f,"finalize",null);0<f.size()&&this.setShapeProperty(27,"setProperties",f);f.clear()}return!0},"~B");l(c$,"modulation",function(){var a=null,b=!0,c=!1,e=null;switch(this.getToken(1).tok){case 1048588:b=!1;case 0:case 1048589:break;case 10:case 1048577:e=this.atomExpressionAt(1);switch(this.tokAt(this.e.iToken+1)){case 1048588:b=!1;case 1048589:this.e.iToken++}this.e.checkLast(this.e.iToken);
break;case 1048586:case 8:a=this.e.getPoint3f(1,!1);c=1048589==this.tokAt(this.e.iToken+1);break;case 3:a=this.floatParameter(1);a=JU.P3.new3(a,a,a);break;case 2:c=this.intParameter(1);a=JU.P3.new3(c,c,c);c=!0;break;case 1073742138:b=this.floatParameter(2);this.chk||this.vwr.setFloatProperty("modulationScale",b);return;default:this.invArg()}this.chk||this.vwr.setModulation(e,b,a,c)});l(c$,"navigate",function(){var a=this.e;if(1==this.slen)a.setBooleanProperty("navigationMode",!0);else{var b=JU.V3.new3(0,
1,0),c=new JU.List,e;if(2==this.slen)switch(this.getToken(1).tok){case 1048589:case 1048588:if(this.chk)return;a.setObjectMad(31,"axes",1);this.setShapeProperty(31,"position",JU.P3.new3(50,50,3.4028235E38));a.setBooleanProperty("navigationMode",!0);this.vwr.setNavOn(1048589==a.theTok);return;case 1073742162:this.chk||this.vwr.setNavXYZ(0,0,0);return;case 8:case 1113200654:break;default:this.invArg()}!this.chk&&!this.vwr.getBoolean(603979887)&&a.setBooleanProperty("navigationMode",!0);for(var d=1;d<
this.slen;d++){var f=this.isFloatParameter(d)?this.floatParameter(d++):2;0>f&&this.invArg();!this.chk&&0<f&&a.refresh(!1);switch(this.getToken(d).tok){case 8:case 1048586:e=this.getPoint3f(d,!0);a.iToken++;a.iToken!=this.slen&&this.invArg();this.chk||this.vwr.setNavXYZ(e.x,e.y,e.z);return;case 554176526:e=this.floatParameter(++d);this.chk||c.addLast([Integer.$valueOf(554176526),Float.$valueOf(f),Float.$valueOf(e)]);continue;case 12289:e=this.centerParameter(++d);d=a.iToken;this.chk||c.addLast([Integer.$valueOf(135266320),
Float.$valueOf(f),e]);continue;case 528432:switch(this.getToken(++d).tok){case 1112541205:b.set(1,0,0);d++;break;case 1112541206:b.set(0,1,0);d++;break;case 1112541207:b.set(0,0,1);d++;break;case 8:case 1048586:b.setT(this.getPoint3f(d,!0));d=a.iToken+1;break;case 1073741824:this.invArg()}e=this.floatParameter(d);this.chk||c.addLast([Integer.$valueOf(528432),Float.$valueOf(f),b,Float.$valueOf(e)]);continue;case 4160:var g=e=NaN;if(this.isFloatParameter(++d))e=this.floatParameter(d),g=this.floatParameter(++d);
else switch(this.tokAt(d)){case 1112541205:e=this.floatParameter(++d);break;case 1112541206:g=this.floatParameter(++d);break;default:e=this.centerParameter(d);d=a.iToken;this.chk||c.addLast([Integer.$valueOf(4160),Float.$valueOf(f),e]);continue}this.chk||c.addLast([Integer.$valueOf(269484210),Float.$valueOf(f),Float.$valueOf(e),Float.$valueOf(g)]);continue;case 269484208:continue;case 1113200654:e=new JU.List;10==this.tokAt(d+1)||1048577==this.tokAt(d+1)?(g=this.atomExpressionAt(++d),d=a.iToken):
g=this.vwr.getSelectedAtoms();if(this.chk)return;this.vwr.getPolymerPointsAndVectors(g,e);var h;if(0<(h=e.size())){for(var g=Array(h),k=0;k<h;k++)g[k]=e.get(k);c.addLast([Integer.$valueOf(1113200654),Float.$valueOf(f),g]);continue}break;case 1073742084:if(1048582==this.getToken(d+1).tok){d++;e=a.objectNameParameter(++d);if(this.chk)return;this.setShapeProperty(22,"thisID",e);e=this.getShapeProperty(22,"vertices");a.refresh(!1);null==e&&this.invArg();g=K(this.isFloatParameter(d+1)?this.floatParameter(++d):
0);h=K(this.isFloatParameter(d+1)?this.floatParameter(++d):2147483647);c.addLast([Integer.$valueOf(1073742084),Float.$valueOf(f),e,null,[g,h]]);continue}for(e=new JU.List;a.isCenterParameter(d+1);)e.addLast(this.centerParameter(++d)),d=a.iToken;if(0<e.size()){e=e.toArray(Array(e.size()));this.chk||c.addLast([Integer.$valueOf(1073742084),Float.$valueOf(f),e,null,[0,2147483647]]);continue}default:this.invArg()}}this.chk||this.vwr.navigateList(a,c)}});da(c$,"plot",function(a){this.st=this.e.st;this.chk=
this.e.chk;var b=this.vwr.getCurrentModelIndex();0>b&&this.e.errorStr(30,"plot");var b=this.vwr.getJmolDataSourceFrame(b),c=a.length-1,e=a!==this.st,d=this.st;e&&(this.e.st=this.st=a);var f=e?4148:a[0].tok,g=e||135270418==f||1052714==f?0:1,h=null,k=!0,l=!1;switch(f){case 135176:k=!1;l=!0;break;case 4148:k=!1;break;case 135270422:k=!1,4==J.scriptext.CmdExt.tokAtArray(c,a)?h=this.stringParameter(c--):1048583==J.scriptext.CmdExt.tokAtArray(c-1,a)?(h=this.paramAsStr(c-2)+"."+this.paramAsStr(c),c-=3):
(this.e.st=this.st=d,this.e.iToken=this.st.length,this.error(13))}var e="",s=null,t="",n=!1,H=!1,m=!1,z=!1,C=0,G=0,r=0,q=JW.BSUtil.copy(this.vwr.getSelectedAtoms()),y="; select "+JW.Escape.eBS(q)+";\n ",z=this.e.optParameterAsString(c).toLowerCase(),x=null,u=null,I=J.scriptext.CmdExt.tokAtArray(g,a);4==I&&(I=J.script.T.getTokFromName(a[g].value));switch(I){default:this.e.iToken=1;this.invArg();break;case 135270408:this.e.iToken=1;z="data";y="";break;case 1716520985:this.e.iToken=g+1;(!J.script.T.tokAttr(C=
this.tokAt(this.e.iToken++),1078984704)||!J.script.T.tokAttr(G=this.tokAt(this.e.iToken++),1078984704))&&this.invArg();J.script.T.tokAttr(r=this.tokAt(this.e.iToken),1078984704)?this.e.iToken++:r=0;32==this.tokAt(this.e.iToken)&&(x=this.getPoint3f(++this.e.iToken,!1),this.e.iToken++);64==this.tokAt(this.e.iToken)&&(u=this.getPoint3f(++this.e.iToken,!1),this.e.iToken++);z="property "+J.script.T.nameOf(C)+" "+J.script.T.nameOf(G)+(0==r?"":" "+J.script.T.nameOf(r));0>q.nextSetBit(0)&&(q=this.vwr.getModelUndeletedAtomsBitSet(b));
t="select "+JW.Escape.eBS(q)+";\n ";break;case 1052714:z.equalsIgnoreCase("draw")&&(z=this.e.optParameterAsString(--c).toLowerCase());z=c>g&&z.startsWith("r");z="ramachandran"+(z?" r":"")+(135176==f?" draw":"");break;case 135270418:case 137363467:e=' "'+this.vwr.getQuaternionFrame()+'"';t="set quaternionFrame"+e+";\n  ";n=!0;z.equalsIgnoreCase("draw")&&(l=!0,z=this.e.optParameterAsString(--c).toLowerCase());m=(H=z.startsWith("deriv")||z.startsWith("diff"))&&0<z.indexOf("2");H&&c--;if(z.equalsIgnoreCase("helix")||
z.equalsIgnoreCase("axis"))H=l=!0,c=-1;z=((c<=g?"":this.e.optParameterAsString(c))+"w").substring(0,1);if(z.equals("a")||z.equals("r"))H=!0;JU.PT.isOneOf(z,";w;x;y;z;r;a;")||this.e.evalError("QUATERNION [w,x,y,z,a,r] [difference][2]",null);z="quaternion "+z+(H?" difference":"")+(m?"2":"")+(l?" draw":"")}this.st=d;if(this.chk)return"";if(k&&(t+="plot "+z,a=this.vwr.getJmolDataFrameIndex(b,t),0<a&&135270422!=f&&4148!=f))return this.vwr.setCurrentModelIndexClear(a,!0),"";d=c=a=null;g=JU.P3.new3(1,1,
1);if(1716520985==I){a=this.e.getBitsetPropertyFloat(q,C|224,null==x?NaN:x.x,null==u?NaN:u.x);c=this.e.getBitsetPropertyFloat(q,G|224,null==x?NaN:x.y,null==u?NaN:u.y);0!=r&&(d=this.e.getBitsetPropertyFloat(q,r|224,null==x?NaN:x.z,null==u?NaN:u.z));null==x&&(x=JU.P3.new3(this.getPlotMinMax(a,!1,C),this.getPlotMinMax(c,!1,G),this.getPlotMinMax(d,!1,r)));null==u&&(u=JU.P3.new3(this.getPlotMinMax(a,!0,C),this.getPlotMinMax(c,!0,G),this.getPlotMinMax(d,!0,r)));JW.Logger.info("plot min/max: "+x+" "+u);
s=new JU.P3;s.ave(u,x);g.sub2(u,x);g.set(g.x/200,g.y/200,g.z/200);J.script.T.tokAttr(C,1095761920)?(g.x=1,s.x=0):0.1<g.x&&10>=g.x&&(g.x=1);J.script.T.tokAttr(G,1095761920)?(g.y=1,s.y=0):0.1<g.y&&10>=g.y&&(g.y=1);J.script.T.tokAttr(r,1095761920)?(g.z=1,s.z=0):0.1<g.z&&10>=g.z&&(g.z=1);0==r&&(s.z=x.z=u.z=g.z=0);for(k=0;k<a.length;k++)a[k]=(a[k]-s.x)/g.x;for(k=0;k<c.length;k++)c[k]=(c[k]-s.y)/g.y;if(0!=r)for(k=0;k<d.length;k++)d[k]=(d[k]-s.z)/g.z;s=[q,a,c,d,x,u,g,s]}if(135270422==f)return this.vwr.writeFileData(h,
"PLOT_"+z,b,s);h=z.equals("data")?"1 0 H 0 0 0 # Jmol PDB-encoded data":this.vwr.getPdbData(b,z,s);if(4148==f)return h;JW.Logger.debugging&&JW.Logger.debug(h);if(135176==f)return this.e.runScript(h),"";f=this.vwr.getFileInfo();q=this.vwr.getBoolean(603979792);this.vwr.setAppendNew(!0);h=null!=h&&null==this.vwr.openStringInlineParamsAppend(h,null,!0);this.vwr.setAppendNew(q);this.vwr.setFileInfo(f);if(!h)return"";f=this.vwr.getModelCount();this.vwr.setJmolDataFrame(t,b,f-1);1716520985!=I&&(t+=";\n"+
y);t=this.vwr.addStateScript(t,!0,!1);h=150;switch(I){default:b="frame 0.0; frame last; reset;select visible;wireframe only;";h=10;break;case 1716520985:this.vwr.setFrameTitle(f-1,z+" plot for model "+this.vwr.getModelNumberDotted(b));b="frame 0.0; frame last; reset;select visible; spacefill 3; wireframe 0;draw plotAxisX"+f+' {100 -100 -100} {-100 -100 -100} "'+J.script.T.nameOf(C)+'";draw plotAxisY'+f+' {-100 100 -100} {-100 -100 -100} "'+J.script.T.nameOf(G)+'";';0!=r&&(b+="draw plotAxisZ"+f+' {-100 -100 100} {-100 -100 -100} "'+
J.script.T.nameOf(r)+'";');break;case 1052714:this.vwr.setFrameTitle(f-1,"ramachandran plot for model "+this.vwr.getModelNumberDotted(b));b="frame 0.0; frame last; reset;select visible; color structure; spacefill 3.0; wireframe 0;draw ramaAxisX"+f+' {100 0 0} {-100 0 0} "phi";draw ramaAxisY'+f+' {0 100 0} {0 -100 0} "psi";';break;case 135270418:case 137363467:this.vwr.setFrameTitle(f-1,z.$replace("w"," ")+e+" for model "+this.vwr.getModelNumberDotted(b)),b=JW.C.getHexCode(this.vwr.getColixBackgroundContrast()),
b="frame 0.0; frame last; reset;select visible; wireframe 0; spacefill 3.0; isosurface quatSphere"+f+" color "+b+" sphere 100.0 mesh nofill frontonly translucent 0.8;draw quatAxis"+f+'X {100 0 0} {-100 0 0} color red "x";draw quatAxis'+f+'Y {0 100 0} {0 -100 0} color green "y";draw quatAxis'+f+'Z {0 0 100} {0 0 -100} color blue "z";color structure;draw quatCenter'+f+"{0 0 0} scale 0.02;"}this.e.runScript(b+y);t.setModelIndex(this.vwr.getCurrentModelIndex());this.vwr.setRotationRadius(h,!0);this.sm.loadShape(30);
this.showString("frame "+this.vwr.getModelNumberDotted(f-1)+(0<z.length?" created: "+z+(n?e:""):""));return""},"~A");l(c$,"polyhedra",function(){var a=this.e,b=!1,c=!1,e=!1,d=!1,f=!1,g=0,h=0;this.sm.loadShape(21);this.setShapeProperty(21,"init",Boolean.TRUE);for(var k="centers",l="radius_",s=3.4028235E38,t=[-2147483648],n=1;n<this.slen;++n){var H=null,m=null;switch(this.getToken(n).tok){case 12291:case 1048589:case 1048588:(n+1!=this.slen||b||1<h||0==h&&"to".equals(k))&&this.error(18);H=1048588==
a.theTok?"off":1048589==a.theTok?"on":"delete";c=!0;break;case 269484436:case 269484080:continue;case 1678770178:0<h&&this.invPO();b=!0;H="bonds";break;case 1666189314:l="radius";continue;case 2:case 3:0<h&&!f&&this.invPO();if(2==a.theTok&&"radius_"===l){H="nVertices";m=Integer.$valueOf(this.intParameter(n));b=!0;break}H="radius_"===l?"radius":l;m=Float.$valueOf(this.floatParameter(n));l="radius_";f=!1;b=!0;break;case 10:case 1048577:e&&this.invPO();2<++h&&a.bad();"to".equals(k)&&(b=!0);H=k;k="to";
m=this.atomExpressionAt(n);n=a.iToken;break;case 1074790746:1<h&&this.invPO();if(10==this.tokAt(n+1)||1048577==this.tokAt(n+1)&&!b){H="toBitSet";m=this.atomExpressionAt(++n);n=a.iToken;b=!0;break}else b||this.error(19);k="to";continue;case 1073741937:b||this.error(19);l="faceCenterOffset";f=!0;continue;case 1073741924:0==h&&this.error(19);l="distanceFactor";f=!0;continue;case 1766856708:case 603979967:case 1073742074:s=this.getColorTrans(a,n,!0,t);n=a.iToken;continue;case 1073741886:case 1073741948:H=
"collapsed";m=1073741886==a.theTok?Boolean.TRUE:Boolean.FALSE;e&&this.error(18);e=!0;break;case 1073742044:case 1073741933:case 1073741956:d&&this.error(18);H=this.paramAsStr(n);d=!0;break;case 1073741964:g=a.theTok;continue;default:if(a.isColorParam(n)){t[0]=a.getArgbParam(n);n=a.iToken;continue}this.invArg()}this.setShapeProperty(21,H,m);if(c)return!1}!b&&(!e&&!d&&0==g)&&this.error(19);b&&this.setShapeProperty(21,"generate",null);-2147483648!=t[0]&&this.setShapeProperty(21,"colorThis",Integer.$valueOf(t[0]));
3.4028235E38!=s&&a.setShapeTranslucency(21,"","translucentThis",s,null);0!=g&&this.setShapeProperty(21,"token",Integer.$valueOf(g));this.setShapeProperty(21,"init",Boolean.FALSE);return!0});da(c$,"evalParallel",function(a,b){var c=(new J.script.ScriptEval).setViewer(this.vwr);c.historyDisabled=!0;c.compiler=new J.script.ScriptCompiler(this.vwr);c.sm=b;try{c.restoreScriptContext(a,!0,!1,!1),c.allowJSThreads=!1,c.dispatchCommands(!1,!1)}catch(e){if(ca(e,Exception))return this.e.vwr.setStringProperty("_errormessage",
""+e),null==c.thisContext&&(JW.Logger.error("Error evaluating context "+e),this.vwr.isJS||e.printStackTrace()),!1;throw e;}return!0},"J.script.ScriptContext,JV.ShapeManager");da(c$,"write",function(a){var b=0,c=0,e,d;null==a?(a=this.st,b=c=1,e=!0,d=this.vwr.isApplet()&&!this.vwr.isSignedApplet()||!this.vwr.haveAccess(JV.Viewer.ACCESS.ALL)||0<this.vwr.getPathForAllFiles().length):(e=!1,d=!0);var f=e?this.slen:a.length,g=0,h=0,k=-1,l=-1,s=-2147483648,t=this.vwr.getBoolean(603979934),n=this.vwr.getExportDriverList(),
H="PNGJ",m=null,z="",C=null,G=null,r=null,q=null,y=null,x=null,u=Array(1),I=!1,D=!1,F=!1,K=null,M=null,v="SPT",T=e&&1==a.length?1073741884:J.scriptext.CmdExt.tokAtArray(b,a);switch(T){case 0:break;case 135271429:this.e.isArrayParameter(b+1)&&(M=this.e.stringParameterSet(++b),r=G=".",c=b=this.e.iToken+1,T=this.tokAt(b));break;default:v=J.script.SV.sValue(this.tokenAt(b,a)).toUpperCase()}e&&1073741848==this.tokAt(this.slen-2)&&(v=this.paramAsStr(this.slen-1).toUpperCase(),c=f,f-=2,T=0);switch(T){case 15:case 6:v=
"VAR";x=this.tokenAt(b++,a);break;case 135270418:case 1052714:case 1716520985:y=this.plot(a);if(!e)return y;break;case 1073741983:v="INLINE";m=J.script.SV.sValue(this.tokenAt(++b,a));b++;break;case 1073742102:v="PGRP";b++;z=J.script.SV.sValue(this.tokenAt(b,a)).toLowerCase();z.equals("draw")&&b++;break;case 1048581:b++;I=!0;break;case 1073742158:case 135271429:for(q=J.script.SV.sValue(this.tokenAt(++b,a)).toLowerCase();q.equals("localpath")||q.equals("remotepath");)q.equals("localpath")?G=J.script.SV.sValue(this.tokenAt(++b,
a)):r=J.script.SV.sValue(this.tokenAt(++b,a)),q=J.script.SV.sValue(this.tokenAt(++b,a)).toLowerCase();v="SPT";break;case 1229984263:case 135368713:case 1610616855:case 135180:case 1073742015:case 1073742018:case 1183762:case 135188:b++;break;case 1073741991:v="ZIPALL";b++;break;case 36868:v="VAR";b+=2;break;case 4115:case 1073741824:case 1073741979:case 1073742139:case 4:case 4166:switch(T){case 1073741979:b++;break;case 4166:h=this.e.intParameterRange(++b,1,10);if(2147483647==h)return"";this.chk||
(this.vwr.setVibrationOff(),this.e.isJS||this.e.delayScript(100));b++;break;case 4115:var P;b+1<f&&1048577==a[++b].tok||10==a[b].tok?(P=this.e.atomExpression(a,b,0,!0,!1,!0,!0),b=this.e.iToken+1):P=this.vwr.getAllAtoms();this.chk||(K=this.vwr.getModelBitSet(P,!0));break;case 1073742139:q=J.script.SV.sValue(this.tokenAt(++b,a)).toUpperCase();JU.PT.isOneOf(q,";PNG;PNGJ;")&&(H=q,b++);break;default:T=1073741979}if(1073741979==T)if(T=J.script.T.getTokenFromName(J.script.SV.sValue(a[b]).toLowerCase()),
null!=T&&(v=J.script.SV.sValue(T).toUpperCase()),JU.PT.isOneOf(v,n.toUpperCase())){b++;v=v.substring(0,1).toUpperCase()+v.substring(1).toLowerCase();D=!0;e&&(C="Jmol."+v.toLowerCase());break}else if(JU.PT.isOneOf(v,";ZIP;ZIPALL;SPT;STATE;")){b++;break}else v="(image)";2==J.scriptext.CmdExt.tokAtArray(b,a)&&(k=J.script.SV.iValue(this.tokenAt(b++,a)),l=J.script.SV.iValue(this.tokenAt(b++,a)))}if(null==y){if(c<f){q=J.script.SV.sValue(this.tokenAt(b,a));if(q.equalsIgnoreCase("clipboard")){if(this.chk)return""}else JU.PT.isOneOf(q.toLowerCase(),
";jpg;jpeg;jpg64;jpeg64;gif;pdf;ppm;png;pngj;pngt;")?(2==J.scriptext.CmdExt.tokAtArray(b+1,a)&&2==J.scriptext.CmdExt.tokAtArray(b+2,a)&&(k=J.script.SV.iValue(this.tokenAt(++b,a)),l=J.script.SV.iValue(this.tokenAt(++b,a))),2==J.scriptext.CmdExt.tokAtArray(b+1,a)&&(s=J.script.SV.iValue(this.tokenAt(++b,a)))):JU.PT.isOneOf(q.toLowerCase(),";xyz;xyzrn;xyzvib;mol;sdf;v2000;v3000;json;pdb;pqr;cml;")&&(v=q.toUpperCase(),b+1==f&&b++);v.equals("(image)")&&JU.PT.isOneOf(q.toLowerCase(),";jpg;jpeg;jpg64;jpeg64;gif;pdf;ppm;png;pngj;pngt;scene;")&&
(v=q.toUpperCase(),b++)}b+2==f&&(y=J.script.SV.sValue(this.tokenAt(++b,a)),0<y.length&&"."!=y.charAt(0)&&(v=q.toUpperCase()));switch(J.scriptext.CmdExt.tokAtArray(b,a)){case 0:d=!0;break;case 1073741884:break;case 1073741824:case 4:C=J.script.SV.sValue(this.tokenAt(b,a));b==f-3&&1048583==J.scriptext.CmdExt.tokAtArray(b+1,a)&&(C+="."+J.script.SV.sValue(this.tokenAt(b+2,a)));if("VAR"!==v&&b==c)v="IMAGE";else if(0<C.length&&"."==C.charAt(0)&&(b==c+1||b==c+2))C=J.script.SV.sValue(this.tokenAt(b-1,a))+
C,"VAR"!==v&&b==c+1&&(v="IMAGE");if(C.equalsIgnoreCase("clipboard")||!this.vwr.haveAccess(JV.Viewer.ACCESS.ALL))C=null;break;default:this.invArg()}if(v.equals("IMAGE")||v.equals("(image)")||v.equals("FRAME")||v.equals("VIBRATION"))v=null!=C&&0<=C.indexOf(".")?C.substring(C.lastIndexOf(".")+1).toUpperCase():"JPG";v.equals("MNU")?v="MENU":v.equals("WRL")||v.equals("VRML")?(v="Vrml",D=!0):v.equals("X3D")?(v="X3d",D=!0):v.equals("IDTF")?(v="Idtf",D=!0):v.equals("MA")?(v="Maya",D=!0):v.equals("JS")?(v=
"Js",D=!0):v.equals("OBJ")?(v="Obj",D=!0):v.equals("JVXL")?v="ISOSURFACE":v.equals("XJVXL")?v="ISOSURFACE":v.equals("JMOL")?v="ZIPALL":v.equals("HIS")&&(v="HISTORY");v.equals("COORD")&&(v=null!=C&&0<=C.indexOf(".")?C.substring(C.lastIndexOf(".")+1).toUpperCase():"XYZ");F=JU.PT.isOneOf(v.toLowerCase(),";jpg;jpeg;jpg64;jpeg64;gif;pdf;ppm;png;pngj;pngt;scene;");null!=M&&(v.equals("PNG")&&(v="PNGJ"),!v.equals("PNGJ")&&!v.equals("ZIPALL")&&this.invArg());!F&&(!D&&!JU.PT.isOneOf(v,";SCENE;JMOL;ZIP;ZIPALL;SPT;HISTORY;MO;ISOSURFACE;MESH;PMESH;VAR;FILE;FUNCTION;CML;JSON;XYZ;XYZRN;XYZVIB;MENU;MOL;PDB;PGRP;PQR;QUAT;RAMA;SDF;V2000;V3000;INLINE;"))&&
this.e.errorStr2(54,"COORDS|FILE|FUNCTIONS|HISTORY|IMAGE|INLINE|ISOSURFACE|JMOL|MENU|MO|POINTGROUP|QUATERNION [w,x,y,z] [derivative]|RAMACHANDRAN|SPT|STATE|VAR x|ZIP|ZIPALL  CLIPBOARD","CML|GIF|JPG|JPG64|JMOL|JVXL|MESH|MOL|PDB|PMESH|PNG|PNGJ|PNGT|PPM|PQR|SDF|CD|JSON|V2000|V3000|SPT|XJVXL|XYZ|XYZRN|XYZVIB|ZIP"+n.toUpperCase().$replace(";","|"));if(this.chk)return"";b=null;c=!1;if(null==m||D){m=v.intern();if(D){t&&JW.Logger.startTimer("export");h=new java.util.Hashtable;h.put("type",m);null!=C&&h.put("fileName",
C);(e||null!=C)&&h.put("fullPath",u);h.put("width",Integer.$valueOf(k));h.put("height",Integer.$valueOf(l));m=this.vwr.generateOutputForExport(h);if(null==m||0==m.length)return"";if(!e)return m;(v.equals("Povray")||v.equals("Idtf"))&&null!=u[0]?(k=v.equals("Idtf")?".tex":".ini",C=u[0]+k,e=new java.util.Hashtable,e.put("fileName",C),e.put("type",k),e.put("text",m),e.put("fullPath",u),y=this.vwr.processWriteOrCapture(e),v.equals("Idtf")&&(m=m.substring(0,m.indexOf("\\begin{comment}"))),m="Created "+
u[0]+":\n\n"+m,t&&this.showString(JW.Logger.getTimerMsg("export",0))):y=m;null!=y&&(y.startsWith("OK")||this.e.evalError(y,null),this.e.report(m));return""}if("MENU"===m)m=this.vwr.getMenu("");else if("PGRP"===m)m=this.vwr.getPointGroupAsString(z.equals("draw"),null,0,1);else if("PDB"===m||"PQR"===m)d?m=this.vwr.getPdbAtomData(null,null):c=!0;else if("FILE"===m)d?m=this.vwr.getCurrentFileAsString():c=!0,"?".equals(C)&&(C="?Jmol."+this.vwr.getParameter("_fileType"));else if(("SDF"===m||"MOL"===m||
"V2000"===m||"V3000"===m||"CD"===m||"JSON"===m)&&I)m=this.vwr.getModelExtract("selected",!0,!1,m),m.startsWith("ERROR:")&&(b=m);else if("XYZ"===m||"XYZRN"===m||"XYZVIB"===m||"MOL"===m||"SDF"===m||"V2000"===m||"V3000"===m||"CML"===m||"CD"===m||"JSON"===m)m=this.vwr.getData("selected",m),m.startsWith("ERROR:")&&(b=m);else if("FUNCTION"===m)m=this.vwr.getFunctionCalls(null),v="TXT";else if("VAR"===m){null==x&&(x=this.e.getParameter(J.script.SV.sValue(this.tokenAt(e?2:1,a)),1073742190));a=null;if(15==
x.tok)a=new JU.List,a.addLast(x.value.data);else if(6==x.tok){if(x=x.value,x.containsKey("$_BINARY_$")&&(a=new JU.List,null!=C))for(var O,x=x.entrySet().iterator();x.hasNext()&&((O=x.next())||1);)z=O.getKey(),G=O.getValue(),b=15==G.tok?G.value.data:null,null==b&&(y=G.asString(),b=y.startsWith(";base64,")?JU.Base64.decodeBase64(y):y.getBytes()),z.equals("_IMAGE_")?(a.add(0,z),a.add(1,b)):z.equals("$_BINARY_$")||(a.addLast(z),a.addLast(null),a.addLast(b))}else m=x.asString(),v="TXT";null!=a&&null!=
C&&null==(b=m=this.vwr.createZip(C,"ZIPDATA",a))&&this.e.evalError("#CANCELED#",null)}else if("SPT"===m)if(I)O=this.vwr.getTaintedAtoms(2),this.vwr.setAtomCoordsRelative(JU.P3.new3(0,0,0),null),m=this.vwr.getStateInfo(),this.vwr.setTaintedAtoms(O,2);else{if(m=this.vwr.getStateInfo(),null!=G||null!=r)m=JV.FileManager.setScriptFileReferences(m,G,r,null)}else"ZIP"===m||"ZIPALL"===m?null!=C&&null==(b=m=this.vwr.createZip(C,v,M))&&this.e.evalError("#CANCELED#",null):"HISTORY"===m?(m=this.vwr.getSetHistory(2147483647),
v="SPT"):"MO"===m?(m=this.getMoJvxl(2147483647),v="XJVXL"):"PMESH"===m?(null==(m=this.getIsosurfaceJvxl(!0,28))&&this.error(31),v="XJVXL"):"ISOSURFACE"===m||"MESH"===m?(null==(m=this.getIsosurfaceJvxl("MESH"===m,24))&&this.error(31),v=0<=m.indexOf("<?xml")?"XJVXL":"JVXL",d||this.showString(this.getShapeProperty(24,"jvxlFileInfo"))):(g=-1,0>s&&(s=-1));null==m&&!c&&(m="");0==g&&!c&&(null==b||V(b,String));F&&(this.e.refresh(!1),0>k&&(k=this.vwr.getScreenWidth()),0>l&&(l=this.vwr.getScreenHeight()))}if(!e)return m;
if(d)return this.e.showStringPrint(m,!0),"";if(null!=b&&V(b,String))return 0!=b.indexOf("OK")&&alert(b),this.e.report(b),b;if(v.equals("SCENE"))b=H;else if(null==b&&(!F||null!=C))b=m;t&&JW.Logger.startTimer("write");c?y=this.vwr.writeFileData(C,v,0,null):(e=new java.util.Hashtable,null!=C&&e.put("fileName",C),e.put("type",v),V(b,String)&&-2147483648==s?e.put("text",b):V(b,Array)&&e.put("bytes",b),null!=M&&e.put("scripts",M),null!=K&&e.put("bsFrames",K),e.put("fullPath",u),e.put("quality",Integer.$valueOf(s)),
e.put("width",Integer.$valueOf(k)),e.put("height",Integer.$valueOf(l)),e.put("nVibes",Integer.$valueOf(h)),y=this.vwr.processWriteOrCapture(e));t&&this.showString(JW.Logger.getTimerMsg("write",0))}return!this.chk&&null!=y?(y.startsWith("OK")||(this.e.evalError(y,null),alert(y)),this.e.report(y+(F?"; width="+k+"; height="+l:"")),y):""},"~A");l(c$,"show",function(){var a=null,b=this.paramAsStr(1),c=null,e=null,d=2,e=this.getToken(1),f=V(e,J.script.SV)?0:e.tok;4==f&&(e=J.script.T.getTokenFromName(b.toLowerCase()),
null!=e&&(f=e.tok));1297090050!=f&&1073742158!=f&&this.checkLength(-3);if(2==this.slen&&0<=b.indexOf("?"))this.showString(this.vwr.getAllSettings(b.substring(0,b.indexOf("?"))));else{switch(f){case 0:this.chk||(c=this.e.theToken.escape());break;case 135270423:this.chk||(c=JW.Escape.e(this.vwr.cacheList()));break;case 1073741915:this.checkLength(2);this.chk||(c=this.vwr.calculateStructures(null,!0,!1));break;case 545259571:this.checkLength(2);this.chk||(c=this.vwr.getPathForAllFiles());break;case 1073742038:if(this.e.optParameterAsString(2).equalsIgnoreCase("1H")){d=
3;this.chk||(c=this.vwr.getNMRPredict(!1));break}this.chk||this.vwr.getNMRPredict(!0);return;case 135267336:case 1073741929:case 1073741879:this.checkLength(1073741879==f?3:2);if(this.chk)return;try{c=this.vwr.getSmiles(null)}catch(g){if(ca(g,Exception))c=g.getMessage();else throw g;}switch(f){case 1073741929:if(0<c.length){this.vwr.show2D(c);return}c="Could not show drawing -- Either insufficient atoms are selected or the model is a PDB file.";break;case 1073741879:d=3,0<c.length?(c=this.vwr.getChemicalInfo(c,
this.getToken(2)),0<=c.indexOf("FileNotFound")&&(c="?")):c="Could not show name -- Either insufficient atoms are selected or the model is a PDB file."}break;case 1297090050:3<this.slen?(d=this.centerParameter(2),f=this.centerParameter(++this.e.iToken),this.chk||(c=this.vwr.getSymmetryOperation(null,0,d,f,!1)),d=++this.e.iToken):(d=2==this.e.checkLength23()?0:this.intParameter(2),this.chk||(c=this.vwr.getSymmetryOperation(null,d,null,null,!1)),d=-3);break;case 1649412120:a=null;2<this.slen&&(a=J.c.VDW.getVdwType(this.paramAsStr(2)),
null==a&&this.invArg());this.chk||this.showString(this.vwr.getDefaultVdwNameOrData(0,a,null));return;case 135368713:this.e.checkLength23();this.chk||this.showString(this.vwr.getFunctionCalls(this.e.optParameterAsString(2)));return;case 1085443:this.checkLength(2);this.chk||this.showString(this.vwr.getAllSettings(null));return;case 1074790760:if(2==this.slen){this.chk||this.vwr.showUrl(this.e.getFullPathName());return}e=this.paramAsStr(2);this.chk||this.vwr.showUrl(e);return;case 1766856708:b="defaultColorScheme";
break;case 1610612740:b="scaleAngstromsPerInch";break;case 135270418:case 1052714:if(this.chk)return;0>this.vwr.getCurrentModelIndex()&&this.e.errorStr(30,"show "+this.e.theToken.value);c=this.plot(this.st);d=this.slen;break;case 14:case 1113200654:this.chk||(c=this.getContext(!1));break;case 1073741888:e=this.e.optParameterAsString(2);0<e.length&&(d=3);this.chk||(a=this.vwr.getColorSchemeList(e));break;case 1073742192:this.chk||(c=this.vwr.getAtomDefs(this.e.definedAtomSets)+this.vwr.getVariableList()+
this.getContext(!0));break;case 536870926:this.chk||(c=this.vwr.getTrajectoryState());break;case 553648148:a=""+this.e.commandHistoryLevelMax;break;case 553648150:a=""+JW.Logger.getLogLevel();break;case 603979825:a=""+this.vwr.getBoolean(603979825);break;case 553648178:c="set strandCountForStrands "+this.vwr.getStrandCount(12)+"; set strandCountForMeshRibbon "+this.vwr.getStrandCount(13);break;case 536875070:c=this.vwr.showTimeout(2==(d=this.slen)?null:this.paramAsStr(2));break;case 536870918:a=JW.Escape.eP(this.vwr.getDefaultLattice());
break;case 4126:this.chk||(c=this.vwr.getMinimizationInfo());break;case 1611272194:switch(this.vwr.getAxesMode()){case J.c.AXES.UNITCELL:c="set axesUnitcell";break;case J.c.AXES.BOUNDBOX:c="set axesWindow";break;default:c="set axesMolecular"}break;case 1610612737:c="set bondMode "+(this.vwr.getBoolean(603979812)?"OR":"AND");break;case 1650071565:this.chk||(c="set strandCountForStrands "+this.vwr.getStrandCount(12)+"; set strandCountForMeshRibbon "+this.vwr.getStrandCount(13));break;case 1612189718:c=
"set hbondsBackbone "+this.vwr.getBoolean(603979852)+";set hbondsSolid "+this.vwr.getBoolean(603979854);break;case 1611141175:this.chk||(c=this.vwr.getSpinState());break;case 1611141176:c="set ssbondsBackbone "+this.vwr.getBoolean(603979952);break;case 1610625028:case 1611141171:c="selectionHalos "+(this.vwr.getSelectionHaloEnabled(!1)?"ON":"OFF");break;case 1613758470:c="set selectHetero "+this.vwr.getBoolean(1613758470);break;case 1073741828:c=JW.Escape.eAP(this.vwr.getAdditionalHydrogens(null,
!0,!0,null));break;case 1613758476:c="set selectHydrogens "+this.vwr.getBoolean(1613758476);break;case 553648130:case 553648142:case 536870924:case 553648176:case 553648172:case 1073741995:this.chk||(c=this.vwr.getSpecularState());break;case 1073742136:case 4146:this.chk||(c=this.vwr.listSavedStates());break;case 1614417948:this.chk||(c=this.vwr.getUnitCellInfoText());break;case 1048581:if(2==(d=this.slen)){this.chk||(c=this.vwr.getCoordinateState(this.vwr.getSelectedAtoms()));break}f=this.paramAsStr(2);
this.chk||(c=this.vwr.getSavedCoordinates(f));break;case 1073742158:this.chk||this.vwr.clearConsole();if(2==(d=this.slen)){this.chk||(c=this.vwr.getStateInfo());break}e=this.paramAsStr(2);if(e.equals("/")&&4==(d=this.slen)){e=this.paramAsStr(3).toLowerCase();if(!this.chk){for(var f=JU.PT.split(this.vwr.getStateInfo(),"\n"),c=new JU.SB,h=0;h<f.length;h++)0<=f[h].toLowerCase().indexOf(e)&&c.append(f[h]).appendC("\n");c=c.toString()}break}else if(1229984263==this.tokAt(2)&&4==(d=this.slen)){this.chk||
(c=this.vwr.getEmbeddedFileState(this.paramAsStr(3)));break}d=3;this.chk||(c=this.vwr.getSavedState(e));break;case 1641025539:if(2==(d=this.slen)){this.chk||(c=this.vwr.getProteinStructureState());break}f=this.paramAsStr(2);this.chk||(c=this.vwr.getSavedStructure(f));break;case 135270408:f=3==(d=this.slen)?this.paramAsStr(2):null;this.chk||(c=null==f?this.lastData:this.vwr.getData(f),c=null==c?"no data":JW.Escape.encapsulateData(c[0],c[1],c[3].intValue()));break;case 1073742152:f=null;2==(d=this.slen)?
this.chk||(f=this.vwr.getSpaceGroupInfo(null)):(e=this.paramAsStr(2),this.chk||(f=this.vwr.getSpaceGroupInfo(JU.PT.rep(e,"''",'"'))));null!=f&&(c=""+f.get("spaceGroupInfo")+f.get("symmetryInfo"));break;case 1048582:d=3;c=this.e.setObjectProperty();break;case 1679429641:this.chk||(c=this.vwr.getBoundBoxCommand(!0));break;case 12289:this.chk||(c="center "+JW.Escape.eP(this.vwr.getRotationCenter()));break;case 135176:this.chk||(c=this.getShapeProperty(22,"command"));break;case 1229984263:this.chk||this.vwr.clearConsole();
if(2==this.slen){this.chk||(c=this.vwr.getCurrentFileAsString());null==c&&(c="<unavailable>");break}d=3;a=this.paramAsStr(2);this.chk||(c=this.vwr.getFileAsString(a,!0));break;case 4115:c=1048579==this.tokAt(2)&&0<(d=3)?this.vwr.getModelFileInfoAll():this.vwr.getModelFileInfo();break;case 1610616855:f=2==(d=this.slen)?2147483647:this.intParameter(2);1>f&&this.invArg();this.chk||(this.vwr.clearConsole(),0==this.e.scriptLevel&&this.vwr.removeCommand(),c=this.vwr.getSetHistory(f));break;case 135180:this.chk||
(c=this.getShapeProperty(24,"jvxlDataXml"));break;case 1183762:this.e.optParameterAsString(2).equalsIgnoreCase("list")?(c=this.vwr.getMoInfo(-1),d=3):(f=2==(d=this.slen)?-2147483648:this.intParameter(2),this.chk||(c=this.getMoJvxl(f)));break;case 1095766030:this.chk||(c=this.vwr.getModelInfoAsString());break;case 537006096:this.chk||(c=this.vwr.getMeasurementInfoAsString());break;case 1073741863:d=3;!this.chk&&this.slen==d&&(c=this.vwr.getOrientationText(this.tokAt(2),null));break;case 1073742132:f=
this.tokAt(2),0==f?f=1073742132:d=3;case 1073742178:case 4130:this.chk||(c=this.vwr.getOrientationText(f,null));break;case 1073742077:d=2;if(3<this.slen)break;switch(f=this.tokAt(2)){case 1073742178:case 1073742132:case 4130:case 0:this.chk||(c=this.vwr.getOrientationText(f,null));break;default:e=this.e.optParameterAsString(2),c=this.vwr.getOrientationText(1073742035,e)}d=this.slen;break;case 1073742088:this.chk||(c=this.vwr.getPDBHeader());break;case 1073742102:this.chk||this.showString(this.vwr.getPointGroupAsString(!1,
null,0,0));return;case 1089470478:this.chk||(c=this.vwr.getSymmetryInfoAsString());break;case 1073742176:this.chk||(c="transform:\n"+this.vwr.getTransformText());break;case 4168:c="zoom "+(this.vwr.getZoomEnabled()?""+this.vwr.getZoomSetting():"off");break;case 1611272202:c=this.vwr.getShowFrank()?"frank ON":"frank OFF";break;case 1666189314:b="solventProbeRadius";break;case 1073741864:case 1087373316:case 1087373320:case 1073742120:case 1114638363:case 1087373318:case 1141899265:case 1073741982:c=
this.vwr.getChimeInfo(f);break;case 537022465:case 1610612738:case 1716520985:case 20482:case 1613758488:a="?";break;case 1073742031:f=2==(d=this.slen)?null:this.paramAsStr(2);this.chk||(c=this.vwr.getBindingInfo(f));break;case 1073742015:this.chk||(a=this.vwr.getMenu(""));break;case 1073741824:b.equalsIgnoreCase("fileHeader")&&(this.chk||(c=this.vwr.getPDBHeader()));break;case 1073741992:case 36868:b=this.paramAsStr(d++),c=this.e.getParameter(b,1073742190),c=1073741992==f?c.toJSON():c.escape()}this.checkLength(d);
this.chk||(null!=c?this.showString(c):null!=a?this.showString(b+" = "+a):null!=b&&(0<=b.indexOf(" ")?this.showString(b):this.showString(b+" = "+this.e.getParameter(b,1073742190).escape())))}});l(c$,"stereo",function(){for(var a=J.c.STER.DOUBLE,b=-5,c=!1,e=null,d=0,f=1;f<this.slen;++f)if(this.e.isColorParam(f))1<d&&this.e.bad(),0==d&&(e=X(2,0)),c||(b=3),e[d]=this.e.getArgbParam(f),0==d++&&(e[1]=~e[0]),f=this.e.iToken;else switch(this.getToken(f).tok){case 1048589:this.e.checkLast(this.e.iToken=1);
this.e.iToken=1;break;case 1048588:this.e.checkLast(this.e.iToken=1);a=J.c.STER.NONE;break;case 2:case 3:b=this.floatParameter(f);c=!0;break;case 1073741824:if(c||(b=3),a=J.c.STER.getStereoMode(this.paramAsStr(f)),null!=a)break;default:this.invArg()}this.chk||this.vwr.setStereoMode(e,a,b)});l(c$,"struts",function(){var a=this.e,b=1073742072==this.tokAt(1)||1048589==this.tokAt(1)||1==this.slen,c=a.getMadParameter();if(2147483647==c)return!1;b&&(c=Math.round(2E3*this.vwr.getFloat(570425406)));this.setShapeProperty(1,
"type",Integer.$valueOf(32768));a.setShapeSizeBs(1,c,null);this.setShapeProperty(1,"type",Integer.$valueOf(1023));return!0});l(c$,"addShapeProperty",function(a,b,c){this.chk||a.addLast([b,c])},"JU.List,~S,~O");l(c$,"assign",function(){var a=this.tokAt(1),b=this.atomExpressionAt(2).nextSetBit(0),c=-1,e=null;if(!(0>b)){4106==a?c=this.atomExpressionAt(++this.e.iToken).nextSetBit(0):e=this.paramAsStr(++this.e.iToken);var d=++this.e.iToken<this.slen?this.centerParameter(this.e.iToken):null;if(!this.chk)switch(a){case 1141899265:this.e.clearDefinedVariableAtomSets();
this.assignAtom(b,d,e);break;case 1678770178:this.assignBond(b,(e+"p").charAt(0));break;case 4106:this.assignConnect(b,c)}}});l(c$,"assignAtom",function(a,b,c){c.equals("X")&&this.vwr.setRotateBondIndex(-1);if(this.vwr.ms.at[a].mi==this.vwr.ms.mc-1){this.vwr.clearModelDependentObjects();var e=this.vwr.ms.getAtomCount();if(null==b)this.vwr.sm.modifySend(a,this.vwr.ms.at[a].mi,1,this.e.fullCommand),this.vwr.ms.assignAtom(a,c,!0),JU.PT.isOneOf(c,";Mi;Pl;X;")||this.vwr.ms.setAtomNamesAndNumbers(a,-e,
null),this.vwr.sm.modifySend(a,this.vwr.ms.at[a].mi,-1,"OK"),this.vwr.refresh(3,"assignAtom");else{var d=this.vwr.ms.at[a],f=JW.BSUtil.newAndSetBit(a);b=[b];var g=new JU.List;g.addLast(d);d=d.mi;this.vwr.sm.modifySend(a,d,3,this.e.fullCommand);try{f=this.vwr.addHydrogensInline(f,g,b),a=f.nextSetBit(0),this.vwr.ms.assignAtom(a,c,!1)}catch(h){if(!ca(h,Exception))throw h;}this.vwr.ms.setAtomNamesAndNumbers(a,-e,null);this.vwr.sm.modifySend(a,d,-3,"OK")}}},"~N,JU.P3,~S");l(c$,"assignBond",function(a,
b){var c=-1;try{var e=this.vwr.ms,c=this.vwr.getAtomModelIndex(e.bo[a].getAtomIndex1());this.vwr.sm.modifySend(a,c,2,this.e.fullCommand);var d=e.setBondOrder(a,b);null==d||"0"==b?this.vwr.refresh(3,"setBondOrder"):this.vwr.addHydrogens(d,!1,!0);this.vwr.sm.modifySend(a,c,-2,""+b)}catch(f){if(ca(f,Exception))JW.Logger.error("assignBond failed"),this.vwr.sm.modifySend(a,c,-2,"ERROR "+f);else throw f;}},"~N,~S");l(c$,"assignConnect",function(a,b){this.vwr.clearModelDependentObjects();var c=this.vwr.ms,
e=JU.AU.newFloat2(1);e[0]=[a,b];var d=c.at[a].mi;this.vwr.sm.modifySend(a,d,2,this.e.fullCommand);c.connect(e);c.assignAtom(a,".",!0);c.assignAtom(b,".",!0);this.vwr.sm.modifySend(a,d,-2,"OK");this.vwr.refresh(3,"assignConnect")},"~N,~N");l(c$,"getContext",function(a){for(var b=new JU.SB,c=this.e.thisContext;null!=c;)a?null!=c.vars&&(b.append(this.getScriptID(c)),b.append(JV.StateManager.getVariableList(c.vars,80,!0,!1))):b.append(J.script.ScriptError.getErrorLineMessage(c.functionName,c.scriptFileName,
this.e.getLinenumber(c),c.pc,J.script.ScriptEval.statementAsString(this.vwr,c.statement,-9999,this.e.debugHigh))),c=c.parentContext;a?null!=this.e.contextVariables&&(b.append(this.getScriptID(null)),b.append(JV.StateManager.getVariableList(this.e.contextVariables,80,!0,!1))):b.append(this.e.getErrorLineMessage2());return b.toString()},"~B");l(c$,"getAtomicPotentials",function(a,b,c){var e=O(this.vwr.getAtomCount(),0),d=J.api.Interface.getOption("quantum.MlpCalculation");d.set(this.vwr);c=null==c?
null:this.vwr.getFileAsString(c,!1);d.assignPotentials(this.vwr.ms.at,e,this.vwr.getSmartsMatch("a",a),this.vwr.getSmartsMatch("/noAromatic/[$(C=O),$(O=C),$(NC=O)]",a),b,c);return e},"JU.BS,JU.BS,~S");l(c$,"getColorTrans",function(a,b,c,e){c=3.4028235E38;1766856708!=a.theTok&&--b;switch(this.tokAt(b+1)){case 603979967:b++;c=this.isFloatParameter(b+1)?a.getTranslucentLevel(++b):this.vwr.getFloat(570425354);break;case 1073742074:b++,c=0}a.isColorParam(b+1)?e[0]=a.getArgbParam(++b):1048587==this.tokAt(b+
1)?(e[0]=0,a.iToken=b+1):3.4028235E38==c?this.invArg():e[0]=-2147483648;return c},"J.script.ScriptEval,~N,~B,~A");l(c$,"getCapSlabObject",function(a,b){if(0>a)return JW.TempArray.getSlabWithinRange(a,0);var c=this.e,e=null,d=554176565==this.tokAt(a),f=this.tokAt(a+1),g=null,h=g=null,k=null,l=null;if(603979967==f)switch(k=this.isFloatParameter(++a+1)?this.floatParameter(++a):0.5,c.isColorParam(a+1)?(k=Short.$valueOf(JW.C.getColixTranslucent3(JW.C.getColix(c.getArgbParam(a+1)),0!=k,k)),a=c.iToken):
k=Short.$valueOf(JW.C.getColixTranslucent3(1,0!=k,k)),f=this.tokAt(a+1)){case 1073742018:case 1073741938:l=Integer.$valueOf(f);f=this.tokAt(++a+1);break;default:l=Integer.$valueOf(1073741938)}switch(f){case 10:case 1048577:e=this.atomExpressionAt(a+1);f=3;c.iToken++;break;case 1048588:return c.iToken=a+1,Integer.$valueOf(-2147483648);case 1048587:c.iToken=a+1;break;case 1048582:a++;e=[Float.$valueOf(1),this.paramAsStr(++a)];f=1073742018;break;case 135266325:a++;if(1073742114==this.tokAt(++a))e=this.floatParameter(++a),
f=this.floatParameter(++a),e=[Float.$valueOf(e),Float.$valueOf(f)],f=1073742114;else if(this.isFloatParameter(a)){e=this.floatParameter(a);if(c.isCenterParameter(++a))if(g=this.centerParameter(a),this.chk||!V(c.expressionResult,JU.BS))g=[g];else for(var s=this.vwr.ms.at,h=c.expressionResult,g=Array(h.cardinality()),t=0,n=h.nextSetBit(0);0<=n;n=h.nextSetBit(n+1),t++)g[t]=s[n];else g=c.getPointArray(a,-1);0==g.length&&(c.iToken=a,this.invArg());e=[Float.$valueOf(e),g,h]}else e=c.getPointArray(a,4),
f=1679429641;break;case 1679429641:c.iToken=a+1;e=JW.BoxInfo.getCriticalPoints(this.vwr.getBoundBoxVertices(),null);break;case 1073741872:case 1614417948:c.iToken=a+1;c=this.vwr.getCurrentUnitCell();if(null==c)1614417948==f&&this.invArg();else{g=JW.BoxInfo.getCriticalPoints(c.getUnitCellVertices(),c.getCartesianOffset());c=K(c.getUnitCellInfoType(6));e=h=null;switch(c){case 1:e=JU.V3.newVsub(g[2],g[0]),e.scale(1E3);case 2:h=JU.V3.newVsub(g[1],g[0]),h.scale(1E3),g[0].sub(h),g[1].scale(2E3),1==c&&(g[0].sub(e),
g[2].scale(2E3))}e=g}break;default:if(!b&&d&&this.isFloatParameter(a+1)){e=this.floatParameter(++a);if(!this.isFloatParameter(a+1))return Integer.$valueOf(K(e));f=this.floatParameter(++a);e=[Float.$valueOf(e),Float.$valueOf(f)];f=1073742114;break}g=c.planeParameter(++a);f=this.isFloatParameter(c.iToken+1)?this.floatParameter(++c.iToken):NaN;Float.isNaN(f)||(g.w-=f);e=g;f=135266319}return JW.TempArray.getSlabObjectType(f,e,!d,null==l?null:[l,k])},"~N,~B");l(c$,"getIsosurfaceJvxl",function(a,b){return this.chk?
"":this.getShapeProperty(b,a?"jvxlMeshX":"jvxlDataXml")},"~B,~N");l(c$,"getMoJvxl",function(a){this.sm.loadShape(27);var b=this.vwr.getCurrentModelIndex();0>b&&this.e.errorStr(30,"MO isosurfaces");var c=this.vwr.getModelAuxiliaryInfoValue(b,"moData");null==c&&this.error(27);var e=this.getShapeProperty(27,"moNumber");(null==e||0==e.intValue())&&this.setShapeProperty(27,"init",Integer.$valueOf(b));this.setShapeProperty(27,"moData",c);return this.getShapePropertyIndex(27,"showMO",a)},"~N");l(c$,"getScriptID",
function(a){return"\n# "+(null==a?this.e.functionName:"function "+a.functionName)+" (file "+(null==a?this.e.scriptFileName:a.scriptFileName)+(null==a?"":" context "+a.id)+")\n"},"J.script.ScriptContext");l(c$,"getShapePropertyIndex",function(a,b,c){return this.sm.getShapePropertyIndex(a,b,c)},"~N,~S,~N");l(c$,"tokenAt",function(a,b){return a<b.length?b[a]:null},"~N,~A");c$.tokAtArray=l(c$,"tokAtArray",function(a,b){return a<b.length&&null!=b[a]?b[a].tok:0},"~N,~A");l(c$,"finalizeObject",function(a,
b,c,e,d,f,g,h){d&&this.setShapeProperty(a,"set",f);-2147483648!=b&&this.e.setShapePropertyBs(a,"color",Integer.$valueOf(b),h);3.4028235E38!=c&&this.e.setShapeTranslucency(a,"","translucent",c,h);0!=e&&this.setShapeProperty(a,"scale",Integer.$valueOf(e));0<g&&(this.e.setMeshDisplayProperty(a,g,0)||this.invArg())},"~N,~N,~N,~N,~B,~O,~N,JU.BS");l(c$,"moCombo",function(a){if(1073742156!=this.tokAt(this.e.iToken+1))return null;this.addShapeProperty(a,"squareLinear",Boolean.TRUE);this.e.iToken++;return O(0,
0)},"JU.List");l(c$,"moOffset",function(a){var b=1073741973==this.getToken(a).tok?0:1,c=this.tokAt(++a);2==c&&0>this.intParameter(a)?b+=this.intParameter(a):269484193==c?b+=this.intParameter(++a):269484192==c&&(b-=this.intParameter(++a));return b},"~N");l(c$,"setMoData",function(a,b,c,e,d,f,g){var h=this.e;if(!this.chk){0>f&&(f=this.vwr.getCurrentModelIndex(),0>f&&h.errorStr(30,"MO isosurfaces"));f=this.vwr.getModelAuxiliaryInfoValue(f,"moData");var k=null,l,s,t=0;if(null==c||2>c.length){null!=c&&
1==c.length&&(e=0);null==f&&this.error(27);var n=f.containsKey("lastMoNumber")?f.get("lastMoNumber").intValue():0,k=f.containsKey("lastMoCount")?f.get("lastMoCount").intValue():1;1073742108==b?b=n-1:1073742037==b&&(b=n+k);k=f.get("mos");t=null==k?0:k.size();0==t&&this.error(25);1==t&&1<b&&this.error(29);if(2147483647!=e){if(f.containsKey("HOMO"))b=f.get("HOMO").intValue()+e;else{b=-1;for(n=0;n<t;n++)if(l=k.get(n),null!=(s=l.get("occupancy"))){if(0.5>s.floatValue()){b=n;break}}else if(null!=(s=l.get("energy"))){if(0<
s.floatValue()){b=n;break}}else break;0>b&&this.error(28);b+=e}JW.Logger.info("MO "+b)}(1>b||b>t)&&h.errorStr(26,""+t)}b=Math.abs(b);f.put("lastMoNumber",Integer.$valueOf(b));f.put("lastMoCount",Integer.$valueOf(1));d&&null==c&&(c=[-100,b]);if(null!=c&&2>c.length){l=k.get(b-1);if(null==(s=l.get("energy")))c=[100,b];else{h=s.floatValue();e=JU.BS.newN(t);d=0;c=1==c.length&&1==c[0];for(n=0;n<t;n++)if(null!=(s=k.get(n).get("energy")))if(s=s.floatValue(),c?s<=h:s==h)e.set(n+1),d+=2;c=O(d,0);for(k=n=0;n<
d;n+=2)c[n]=1,c[n+1]=k=e.nextSetBit(k+1);f.put("lastMoNumber",Integer.$valueOf(e.nextSetBit(0)));f.put("lastMoCount",Integer.$valueOf(Ma(d/2)))}this.addShapeProperty(a,"squareLinear",Boolean.TRUE)}this.addShapeProperty(a,"moData",f);null!=g&&this.addShapeProperty(a,"title",g);this.addShapeProperty(a,"molecularOrbital",null!=c?c:Integer.$valueOf(Math.abs(b)));this.addShapeProperty(a,"clear",null)}},"JU.List,~N,~A,~N,~B,~N,~S");l(c$,"getPlotMinMax",function(a,b,c){if(null==a)return 0;switch(c){case 1112539144:case 1112539145:case 1112539146:return b?
180:-180;case 1112539141:case 1112539152:return b?360:0;case 1112539150:return b?1:-1}c=b?-1E10:1E10;for(var e=a.length;0<=--e;){var d=a[e];Float.isNaN(d)||b==d>c&&(c=d)}return c},"~A,~B,~N");l(c$,"initIsosurface",function(a){var b=this.e;this.setShapeProperty(a,"init",this.fullCommand);b.iToken=0;var c=this.tokAt(1),e=this.tokAt(2);if(12291==c||12291==e&&1048579==this.tokAt(++b.iToken))return this.setShapeProperty(a,"delete",null),b.iToken+=2,this.slen>b.iToken&&(this.setShapeProperty(a,"init",this.fullCommand),
this.setShapeProperty(a,"thisID","+PREVIOUS_MESH+")),null;b.iToken=1;return!b.setMeshDisplayProperty(a,0,c)&&(this.setShapeProperty(a,"thisID","+PREVIOUS_MESH+"),22!=a&&this.setShapeProperty(a,"title",[this.thisCommand]),1074790550!=c&&(269484209==e||269484209==c&&b.setMeshDisplayProperty(a,0,e)))?(a=this.setShapeId(a,1,!1),b.iToken++,a):null},"~N");l(c$,"getWithinDistanceVector",function(a,b,c,e,d){var f=new JU.List,g=Array(2);if(null==e){var h=JU.P3.new3(b,b,b),k=JU.P3.newP(c);k.sub(h);h.add(c);
g[0]=k;g[1]=h;f.addLast(c)}else c=this.vwr.getBoxInfo(e,-Math.abs(b)),g[0]=c.getBoundBoxVertices()[0],g[1]=c.getBoundBoxVertices()[7],1==e.cardinality()&&f.addLast(this.vwr.getAtomPoint3f(e.nextSetBit(0)));1==f.size()&&!d&&(this.addShapeProperty(a,"withinDistance",Float.$valueOf(b)),this.addShapeProperty(a,"withinPoint",f.get(0)));this.addShapeProperty(a,d?"displayWithin":"withinPoints",[Float.$valueOf(b),g,e,f])},"JU.List,~N,JU.P3,JU.BS,~B");l(c$,"setColorOptions",function(a,b,c,e){var d=this.e;
this.getToken(b);var f="opaque";if(603979967==d.theTok)if(f="translucent",0>e){var g=this.isFloatParameter(b+1)?this.floatParameter(++b):3.4028235E38;d.setShapeTranslucency(c,null,"translucent",g,null);null!=a&&(a.append(" translucent"),3.4028235E38!=g&&a.append(" ").appendF(g))}else d.setMeshDisplayProperty(c,b,d.theTok);else 1073742074==d.theTok?0<=e&&d.setMeshDisplayProperty(c,b,d.theTok):d.iToken--;e=Math.abs(e);for(g=0;g<e;g++)if(d.isColorParam(d.iToken+1)){var h=d.getArgbParam(++d.iToken);this.setShapeProperty(c,
"colorRGB",Integer.$valueOf(h));null!=a&&a.append(" ").append(JW.Escape.escapeColor(h))}else if(d.iToken<b)this.invArg();else break;return f},"JU.SB,~N,~N,~N");l(c$,"createFunction",function(a,b,c){var e=(new J.script.ScriptEval).setViewer(this.vwr);try{e.compileScript(null,"function "+a+"("+b+") { return "+c+"}",!1);var d=new JU.List;for(a=0;a<b.length;a+=2)d.addLast(J.script.SV.newV(3,Float.$valueOf(0)).setName(b.substring(a,a+1)));return[e.aatoken[0][1].value,d]}catch(f){if(ca(f,Exception))return null;
throw f;}},"~S,~S,~S");l(c$,"floatArraySet",function(a,b,c){var e=this.tokAt(a++);1073742195==e&&(e=this.tokAt(a++));269484096!=e&&this.invArg();for(var d=JU.AU.newFloat2(b),f=0;269484097!=e;)switch(e=this.getToken(a).tok,e){case 1073742195:case 269484097:continue;case 269484080:a++;break;case 269484096:a++;e=O(c,0);d[f++]=e;for(var g=0;g<c;g++)e[g]=this.floatParameter(a++),269484080==this.tokAt(a)&&a++;269484097!=this.tokAt(a++)&&this.invArg();e=0;f==b&&269484097!=this.tokAt(a)&&this.invArg();break;
default:this.invArg()}return d},"~N,~N,~N");l(c$,"floatArraySetXYZ",function(a,b,c,e){var d=this.e,f=this.tokAt(a++);1073742195==f&&(f=this.tokAt(a++));(269484096!=f||0>=b)&&this.invArg();for(var g=JU.AU.newFloat3(b,-1),h=0;269484097!=f;)switch(f=this.getToken(a).tok,f){case 1073742195:case 269484097:continue;case 269484080:a++;break;case 269484096:g[h++]=this.floatArraySet(a,c,e);a=++d.iToken;f=0;h==b&&269484097!=this.tokAt(a)&&this.invArg();break;default:this.invArg()}return g},"~N,~N,~N,~N");da(c$,
"getBitsetIdent",function(a,b,c,e,d,f){var g=!V(c,JM.BondSet);g&&(null==b?b=this.vwr.getStandardLabelFormat(0):0==b.length&&(b="%[label]"));var h=null==b?-1:b.indexOf("%"),k=2147483647!=d;if(null==a||this.chk||g&&0>h)return null==b&&(b=""),f?[b]:b;var h=this.vwr.ms,l=0,s=h.getLabeler();c=g||!e?null:c.getAssociatedAtoms();null==c&&(null!=b&&0<b.indexOf("%D"))&&(c=this.vwr.getAtomIndices(a));e=null==b||0==b.length;var t=g||e?null:JM.LabelToken.getBondLabelValues();b=e?null:g?s.compile(this.vwr,b,"\x00",
null):s.compile(this.vwr,b,"\u0001",t);var n=k?1:JW.BSUtil.cardinalityOf(a),H=Array(n);for(d=k?d:a.nextSetBit(0);0<=d;d=a.nextSetBit(d+1)){var m;g?m=e?h.at[d].getInfo():s.formatLabelAtomArray(this.vwr,h.at[d],b,"\x00",c):(m=h.getBondAt(d),m=e?m.getIdentity():s.formatLabelBond(this.vwr,m,b,t,c));m=JW.Txt.formatStringI(m,"#",l+1);H[l++]=m;if(k)break}return 1==n&&!f?H[0]:H},"JU.BS,~S,~O,~B,~N,~B");l(c$,"listIsosurface",function(a){var b=3<this.slen?"0":0==this.tokAt(2)?"":" "+this.getToken(2).value;
this.chk||this.showString(this.getShapeProperty(a,"list"+b));return!0},"~N");l(c$,"setShapeId",function(a,b,c){c&&this.invArg();b=this.e.setShapeNameParameter(b).toLowerCase();this.setShapeProperty(a,"thisID",b);return b},"~N,~N,~B");l(c$,"parseDataArray",function(a,b){a=JW.Parser.fixDataString(a);var c=JW.Parser.markLines(a,"\n"),e=c.length;if(!b){for(var d=JU.AU.newFloat2(e),f=0,g=0;f<e;g=c[f++])g=JU.PT.getTokens(a.substring(g,c[f])),JU.PT.parseFloatArrayData(g,d[f]=O(g.length,0));return d}g=JU.PT.getTokens(a.substring(0,
c[0]));if(3!=g.length)return O(0,0,0,0);var h=JU.PT.parseInt(g[0]),k=JU.PT.parseInt(g[1]),l=JU.PT.parseInt(g[2]);if(1>h||1>k||1>l)return O(1,1,1,0);for(var d=JU.AU.newFloat3(h,k),s=0,t=0,f=1,g=c[0];f<e&&s<h;g=c[f++])g=JU.PT.getTokens(a.substring(g,c[f])),g.length<l||(JU.PT.parseFloatArrayData(g,d[s][t]=O(g.length,0)),++t==k&&(s++,t=0));return s!=h?(System.out.println("Error reading 3D data -- nX = "+h+", but only "+s+" blocks read"),O(1,1,1,0)):d},"~S,~B");Jb(c$,"ERROR_invalidArgument",22)})})(Clazz,
Clazz.doubleToInt,Clazz.declarePackage,Clazz.instanceOf,Clazz.load,Clazz.instantialize,Clazz.decorateAsClass,Clazz.floatToInt,Clazz.makeConstructor,Clazz.defineEnumConstant,Clazz.exceptionOf,Clazz.newIntArray,Clazz.defineStatics,Clazz.newFloatArray,Clazz.declareType,Clazz.prepareFields,Clazz.superConstructor,Clazz.newByteArray,Clazz.declareInterface,Clazz.p0p,Clazz.pu$h,Clazz.newShortArray,Clazz.innerTypeInstance,Clazz.isClassDefined,Clazz.prepareCallback,Clazz.newArray,Clazz.castNullAs,Clazz.floatToShort,
Clazz.superCall,Clazz.decorateAsType,Clazz.newBooleanArray,Clazz.newCharArray,Clazz.implementOf,Clazz.newDoubleArray,Clazz.overrideConstructor,Clazz.clone,Clazz.doubleToShort,Clazz.getInheritedLevel,Clazz.getParamsType,Clazz.isAF,Clazz.isAI,Clazz.isAS,Clazz.isASS,Clazz.isAP,Clazz.isAFloat,Clazz.isAII,Clazz.isAFF,Clazz.isAFFF,Clazz.tryToSearchAndExecute,Clazz.getStackTrace,Clazz.inheritArgs,Clazz.alert,Clazz.defineMethod,Clazz.overrideMethod,Clazz.declareAnonymous,Clazz.cloneFinals);
